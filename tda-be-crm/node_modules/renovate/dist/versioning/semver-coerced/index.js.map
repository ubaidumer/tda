{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../lib/versioning/semver-coerced/index.ts"],"names":[],"mappings":"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","sourcesContent":["import semver, { SemVer } from 'semver';\nimport stable from 'semver-stable';\nimport { regEx } from '../../util/regex';\nimport type { NewValueConfig, VersioningApi } from '../types';\n\nexport const id = 'semver-coerced';\nexport const displayName = 'Coerced Semantic Versioning';\nexport const urls = ['https://semver.org/'];\nexport const supportsRanges = false;\n\nconst { is: isStable } = stable;\n\nfunction sortVersions(a: string, b: string): number {\n  return semver.compare(semver.coerce(a), semver.coerce(b));\n}\n\nfunction getMajor(a: string | SemVer): number | null {\n  return semver.major(semver.coerce(a));\n}\n\nfunction getMinor(a: string | SemVer): number | null {\n  return semver.minor(semver.coerce(a));\n}\n\nfunction getPatch(a: string | SemVer): number | null {\n  return semver.patch(a);\n}\n\nfunction matches(version: string, range: string): boolean {\n  return semver.satisfies(semver.coerce(version), range);\n}\n\nfunction equals(a: string, b: string): boolean {\n  return semver.eq(semver.coerce(a), semver.coerce(b));\n}\n\nfunction isValid(version: string): string | boolean | null {\n  return semver.valid(semver.coerce(version));\n}\n\nfunction getSatisfyingVersion(\n  versions: string[],\n  range: string\n): string | null {\n  const coercedVersions = versions.map((version) => {\n    const coercedVersion = semver.coerce(version);\n    return coercedVersion ? coercedVersion.version : null;\n  });\n  return semver.maxSatisfying(coercedVersions, range);\n}\n\nfunction minSatisfyingVersion(\n  versions: string[],\n  range: string\n): string | null {\n  const coercedVersions = versions.map((version) => {\n    const coercedVersion = semver.coerce(version);\n    return coercedVersion ? coercedVersion.version : null;\n  });\n  return semver.minSatisfying(coercedVersions, range);\n}\n\nfunction isLessThanRange(version: string, range: string): boolean {\n  return semver.ltr(semver.coerce(version), range);\n}\n\nfunction isGreaterThan(version: string, other: string): boolean {\n  return semver.gt(semver.coerce(version), semver.coerce(other));\n}\n\nconst startsWithNumberRegex = regEx(`^\\\\d`);\n\nfunction isSingleVersion(version: string): string | boolean | null {\n  // Since coercion accepts ranges as well as versions, we have to manually\n  // check that the version string starts with either 'v' or a digit.\n  if (!version.startsWith('v') && !startsWithNumberRegex.exec(version)) {\n    return null;\n  }\n\n  return semver.valid(semver.coerce(version));\n}\n\n// If this is left as an alias, inputs like \"17.04.0\" throw errors\nexport const isVersion = (input: string): string | boolean => isValid(input);\n\nexport { isVersion as isValid, getSatisfyingVersion };\n\nfunction getNewValue({ newVersion }: NewValueConfig): string {\n  return newVersion;\n}\n\nexport const api: VersioningApi = {\n  equals,\n  getMajor,\n  getMinor,\n  getPatch,\n  isCompatible: isVersion,\n  isGreaterThan,\n  isLessThanRange,\n  isSingleVersion,\n  isStable,\n  isValid,\n  isVersion,\n  matches,\n  getSatisfyingVersion,\n  minSatisfyingVersion,\n  getNewValue,\n  sortVersions,\n};\nexport default api;\n"]}