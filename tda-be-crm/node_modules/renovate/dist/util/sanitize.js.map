{"version":3,"file":"sanitize.js","sourceRoot":"","sources":["../../lib/util/sanitize.ts"],"names":[],"mappings":";;;AAAA,MAAM,OAAO,GAAG,IAAI,GAAG,EAAU,CAAC;AAErB,QAAA,cAAc,GAAG;IAC5B,eAAe;IACf,OAAO;IACP,cAAc;IACd,UAAU;IACV,OAAO;IACP,YAAY;IACZ,eAAe;IACf,eAAe;IACf,WAAW;IACX,UAAU;CACX,CAAC;AAEF,SAAgB,QAAQ,CAAC,KAAa;IACpC,IAAI,CAAC,KAAK,EAAE;QACV,OAAO,KAAK,CAAC;KACd;IACD,IAAI,MAAM,GAAW,KAAK,CAAC;IAC3B,OAAO,CAAC,OAAO,CAAC,CAAC,MAAM,EAAE,EAAE;QACzB,OAAO,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;YAC9B,MAAM,GAAG,MAAM,CAAC,OAAO,CAAC,MAAM,EAAE,cAAc,CAAC,CAAC;SACjD;IACH,CAAC,CAAC,CAAC;IACH,OAAO,MAAM,CAAC;AAChB,CAAC;AAXD,4BAWC;AAED,SAAgB,GAAG,CAAC,MAAc;IAChC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;IACpB,OAAO,CAAC,GAAG,CAAC,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,OAAO,CAAC,iBAAiB,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,oBAAoB;AAC3E,CAAC;AAHD,kBAGC;AAED,SAAgB,KAAK;IACnB,OAAO,CAAC,KAAK,EAAE,CAAC;AAClB,CAAC;AAFD,sBAEC","sourcesContent":["const secrets = new Set<string>();\n\nexport const redactedFields = [\n  'authorization',\n  'token',\n  'githubAppKey',\n  'npmToken',\n  'npmrc',\n  'privateKey',\n  'privateKeyOld',\n  'gitPrivateKey',\n  'forkToken',\n  'password',\n];\n\nexport function sanitize(input: string): string {\n  if (!input) {\n    return input;\n  }\n  let output: string = input;\n  secrets.forEach((secret) => {\n    while (output.includes(secret)) {\n      output = output.replace(secret, '**redacted**');\n    }\n  });\n  return output;\n}\n\nexport function add(secret: string): void {\n  secrets.add(secret);\n  secrets.add(secret?.replace('x-access-token:', '')); // GitHub App tokens\n}\n\nexport function clear(): void {\n  secrets.clear();\n}\n"]}