{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../lib/platform/azure/index.ts"],"names":[],"mappings":"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","sourcesContent":["import is from '@sindresorhus/is';\nimport {\n  GitPullRequest,\n  GitPullRequestCommentThread,\n  GitPullRequestMergeStrategy,\n  GitStatus,\n  GitStatusState,\n  GitVersionDescriptor,\n  PullRequestStatus,\n} from 'azure-devops-node-api/interfaces/GitInterfaces';\nimport delay from 'delay';\nimport JSON5 from 'json5';\nimport { PlatformId } from '../../constants';\nimport { REPOSITORY_EMPTY } from '../../constants/error-messages';\nimport { logger } from '../../logger';\nimport { BranchStatus, PrState, VulnerabilityAlert } from '../../types';\nimport * as git from '../../util/git';\nimport * as hostRules from '../../util/host-rules';\nimport { regEx } from '../../util/regex';\nimport { sanitize } from '../../util/sanitize';\nimport { ensureTrailingSlash } from '../../util/url';\nimport type {\n  BranchStatusConfig,\n  CreatePRConfig,\n  EnsureCommentConfig,\n  EnsureCommentRemovalConfig,\n  EnsureIssueResult,\n  FindPRConfig,\n  Issue,\n  MergePRConfig,\n  PlatformParams,\n  PlatformResult,\n  Pr,\n  RepoParams,\n  RepoResult,\n  UpdatePrConfig,\n} from '../types';\nimport { smartTruncate } from '../utils/pr-body';\nimport * as azureApi from './azure-got-wrapper';\nimport * as azureHelper from './azure-helper';\nimport { AzurePr, AzurePrVote } from './types';\nimport {\n  getBranchNameWithoutRefsheadsPrefix,\n  getGitStatusContextCombinedName,\n  getGitStatusContextFromCombinedName,\n  getNewBranchName,\n  getProjectAndRepo,\n  getRenovatePRFormat,\n  getRepoByName,\n  getStorageExtraCloneOpts,\n  max4000Chars,\n  streamToString,\n} from './util';\n\ninterface Config {\n  repoForceRebase: boolean;\n  defaultMergeMethod: GitPullRequestMergeStrategy;\n  mergeMethods: Record<string, GitPullRequestMergeStrategy>;\n  owner: string;\n  repoId: string;\n  project: string;\n  prList: AzurePr[];\n  fileList: null;\n  repository: string;\n  defaultBranch: string;\n}\n\ninterface User {\n  id: string;\n  name: string;\n}\n\nlet config: Config = {} as any;\n\nconst defaults: {\n  endpoint?: string;\n  hostType: string;\n} = {\n  hostType: PlatformId.Azure,\n};\n\nexport function initPlatform({\n  endpoint,\n  token,\n  username,\n  password,\n}: PlatformParams): Promise<PlatformResult> {\n  if (!endpoint) {\n    throw new Error('Init: You must configure an Azure DevOps endpoint');\n  }\n  if (!token && !(username && password)) {\n    throw new Error(\n      'Init: You must configure an Azure DevOps token, or a username and password'\n    );\n  }\n  // TODO: Add a connection check that endpoint/token combination are valid (#9593)\n  const res = {\n    endpoint: ensureTrailingSlash(endpoint),\n  };\n  defaults.endpoint = res.endpoint;\n  azureApi.setEndpoint(res.endpoint);\n  const platformConfig: PlatformResult = {\n    endpoint: defaults.endpoint,\n  };\n  return Promise.resolve(platformConfig);\n}\n\nexport async function getRepos(): Promise<string[]> {\n  logger.debug('Autodiscovering Azure DevOps repositories');\n  const azureApiGit = await azureApi.gitApi();\n  const repos = await azureApiGit.getRepositories();\n  return repos.map((repo) => `${repo.project.name}/${repo.name}`);\n}\n\nexport async function getRawFile(\n  fileName: string,\n  repoName?: string,\n  branchOrTag?: string\n): Promise<string | null> {\n  const azureApiGit = await azureApi.gitApi();\n\n  let repoId: string;\n  if (repoName) {\n    const repos = await azureApiGit.getRepositories();\n    const repo = getRepoByName(repoName, repos);\n    repoId = repo.id;\n  } else {\n    repoId = config.repoId;\n  }\n\n  const versionDescriptor: GitVersionDescriptor = {\n    version: branchOrTag,\n  } as GitVersionDescriptor;\n\n  const buf = await azureApiGit.getItemContent(\n    repoId,\n    fileName,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    branchOrTag ? versionDescriptor : undefined\n  );\n\n  const str = await streamToString(buf);\n  return str;\n}\n\nexport async function getJsonFile(\n  fileName: string,\n  repoName?: string,\n  branchOrTag?: string\n): Promise<any | null> {\n  const raw = await getRawFile(fileName, repoName, branchOrTag);\n  if (fileName.endsWith('.json5')) {\n    return JSON5.parse(raw);\n  }\n  return JSON.parse(raw);\n}\n\nexport async function initRepo({\n  repository,\n  cloneSubmodules,\n}: RepoParams): Promise<RepoResult> {\n  logger.debug(`initRepo(\"${repository}\")`);\n  config = { repository } as Config;\n  const azureApiGit = await azureApi.gitApi();\n  const repos = await azureApiGit.getRepositories();\n  const repo = getRepoByName(repository, repos);\n  logger.debug({ repositoryDetails: repo }, 'Repository details');\n  // istanbul ignore if\n  if (!repo.defaultBranch) {\n    logger.debug('Repo is empty');\n    throw new Error(REPOSITORY_EMPTY);\n  }\n  config.repoId = repo.id;\n  config.project = repo.project.name;\n  config.owner = '?owner?';\n  logger.debug(`${repository} owner = ${config.owner}`);\n  const defaultBranch = repo.defaultBranch.replace('refs/heads/', '');\n  config.defaultBranch = defaultBranch;\n  logger.debug(`${repository} default branch = ${defaultBranch}`);\n  const names = getProjectAndRepo(repository);\n  config.defaultMergeMethod = await azureHelper.getMergeMethod(\n    repo.id,\n    names.project,\n    null,\n    defaultBranch\n  );\n  config.mergeMethods = {};\n  config.repoForceRebase = false;\n\n  const [projectName, repoName] = repository.split('/');\n  const opts = hostRules.find({\n    hostType: defaults.hostType,\n    url: defaults.endpoint,\n  });\n  const manualUrl =\n    defaults.endpoint +\n    `${encodeURIComponent(projectName)}/_git/${encodeURIComponent(repoName)}`;\n  const url = repo.remoteUrl || manualUrl;\n  await git.initRepo({\n    ...config,\n    url,\n    extraCloneOpts: getStorageExtraCloneOpts(opts),\n    cloneSubmodules,\n  });\n  const repoConfig: RepoResult = {\n    defaultBranch,\n    isFork: false,\n  };\n  return repoConfig;\n}\n\nexport function getRepoForceRebase(): Promise<boolean> {\n  return Promise.resolve(config.repoForceRebase === true);\n}\n\nexport async function getPrList(): Promise<AzurePr[]> {\n  logger.debug('getPrList()');\n  if (!config.prList) {\n    const azureApiGit = await azureApi.gitApi();\n    let prs: GitPullRequest[] = [];\n    let fetchedPrs: GitPullRequest[];\n    let skip = 0;\n    do {\n      fetchedPrs = await azureApiGit.getPullRequests(\n        config.repoId,\n        { status: 4 },\n        config.project,\n        0,\n        skip,\n        100\n      );\n      prs = prs.concat(fetchedPrs);\n      skip += 100;\n    } while (fetchedPrs.length > 0);\n\n    config.prList = prs.map(getRenovatePRFormat);\n    logger.debug({ length: config.prList.length }, 'Retrieved Pull Requests');\n  }\n  return config.prList;\n}\n\nexport async function getPr(pullRequestId: number): Promise<Pr | null> {\n  logger.debug(`getPr(${pullRequestId})`);\n  if (!pullRequestId) {\n    return null;\n  }\n  const azurePr = (await getPrList()).find(\n    (item) => item.number === pullRequestId\n  );\n\n  if (!azurePr) {\n    return null;\n  }\n\n  const azureApiGit = await azureApi.gitApi();\n  const labels = await azureApiGit.getPullRequestLabels(\n    config.repoId,\n    pullRequestId\n  );\n\n  azurePr.labels = labels\n    .filter((label) => label.active)\n    .map((label) => label.name);\n  azurePr.hasReviewers = is.nonEmptyArray(azurePr.reviewers);\n  return azurePr;\n}\n\nexport async function findPr({\n  branchName,\n  prTitle,\n  state = PrState.All,\n}: FindPRConfig): Promise<Pr | null> {\n  let prsFiltered: Pr[] = [];\n  try {\n    const prs = await getPrList();\n\n    prsFiltered = prs.filter(\n      (item) => item.sourceRefName === getNewBranchName(branchName)\n    );\n\n    if (prTitle) {\n      prsFiltered = prsFiltered.filter((item) => item.title === prTitle);\n    }\n\n    switch (state) {\n      case PrState.All:\n        // no more filter needed, we can go further...\n        break;\n      case PrState.NotOpen:\n        prsFiltered = prsFiltered.filter((item) => item.state !== PrState.Open);\n        break;\n      default:\n        prsFiltered = prsFiltered.filter((item) => item.state === state);\n        break;\n    }\n  } catch (err) {\n    logger.error({ err }, 'findPr error');\n  }\n  if (prsFiltered.length === 0) {\n    return null;\n  }\n  return prsFiltered[0];\n}\n\nexport async function getBranchPr(branchName: string): Promise<Pr | null> {\n  logger.debug(`getBranchPr(${branchName})`);\n  const existingPr = await findPr({\n    branchName,\n    state: PrState.Open,\n  });\n  return existingPr ? getPr(existingPr.number) : null;\n}\n\nasync function getStatusCheck(branchName: string): Promise<GitStatus[]> {\n  const azureApiGit = await azureApi.gitApi();\n  const branch = await azureApiGit.getBranch(\n    config.repoId,\n    getBranchNameWithoutRefsheadsPrefix(branchName)\n  );\n  // only grab the latest statuses, it will group any by context\n  return azureApiGit.getStatuses(\n    branch.commit.commitId,\n    config.repoId,\n    undefined,\n    undefined,\n    undefined,\n    true\n  );\n}\n\nconst azureToRenovateStatusMapping: Record<GitStatusState, BranchStatus> = {\n  [GitStatusState.Succeeded]: BranchStatus.green,\n  [GitStatusState.NotApplicable]: BranchStatus.green,\n  [GitStatusState.NotSet]: BranchStatus.yellow,\n  [GitStatusState.Pending]: BranchStatus.yellow,\n  [GitStatusState.Error]: BranchStatus.red,\n  [GitStatusState.Failed]: BranchStatus.red,\n};\n\nexport async function getBranchStatusCheck(\n  branchName: string,\n  context: string\n): Promise<BranchStatus | null> {\n  const res = await getStatusCheck(branchName);\n  for (const check of res) {\n    if (getGitStatusContextCombinedName(check.context) === context) {\n      return azureToRenovateStatusMapping[check.state] || BranchStatus.yellow;\n    }\n  }\n  return null;\n}\n\nexport async function getBranchStatus(\n  branchName: string\n): Promise<BranchStatus> {\n  logger.debug(`getBranchStatus(${branchName})`);\n  const statuses = await getStatusCheck(branchName);\n  logger.debug({ branch: branchName, statuses }, 'branch status check result');\n  if (!statuses.length) {\n    logger.debug('empty branch status check result = returning \"pending\"');\n    return BranchStatus.yellow;\n  }\n  const noOfFailures = statuses.filter(\n    (status: GitStatus) =>\n      status.state === GitStatusState.Error ||\n      status.state === GitStatusState.Failed\n  ).length;\n  if (noOfFailures) {\n    return BranchStatus.red;\n  }\n  const noOfPending = statuses.filter(\n    (status: GitStatus) =>\n      status.state === GitStatusState.NotSet ||\n      status.state === GitStatusState.Pending\n  ).length;\n  if (noOfPending) {\n    return BranchStatus.yellow;\n  }\n  return BranchStatus.green;\n}\n\nexport async function createPr({\n  sourceBranch,\n  targetBranch,\n  prTitle: title,\n  prBody: body,\n  labels,\n  draftPR = false,\n  platformOptions,\n}: CreatePRConfig): Promise<Pr> {\n  const sourceRefName = getNewBranchName(sourceBranch);\n  const targetRefName = getNewBranchName(targetBranch);\n  const description = max4000Chars(sanitize(body));\n  const azureApiGit = await azureApi.gitApi();\n  const workItemRefs = [\n    {\n      id: platformOptions?.azureWorkItemId?.toString(),\n    },\n  ];\n  let pr: GitPullRequest = await azureApiGit.createPullRequest(\n    {\n      sourceRefName,\n      targetRefName,\n      title,\n      description,\n      workItemRefs,\n      isDraft: draftPR,\n    },\n    config.repoId\n  );\n  if (platformOptions?.usePlatformAutomerge) {\n    pr = await azureApiGit.updatePullRequest(\n      {\n        autoCompleteSetBy: {\n          id: pr.createdBy.id,\n        },\n        completionOptions: {\n          mergeStrategy: config.defaultMergeMethod,\n          deleteSourceBranch: true,\n          mergeCommitMessage: title,\n        },\n      },\n      config.repoId,\n      pr.pullRequestId\n    );\n  }\n  if (platformOptions?.azureAutoApprove) {\n    await azureApiGit.createPullRequestReviewer(\n      {\n        reviewerUrl: pr.createdBy.url,\n        vote: AzurePrVote.Approved,\n        isFlagged: false,\n        isRequired: false,\n      },\n      config.repoId,\n      pr.pullRequestId,\n      pr.createdBy.id\n    );\n  }\n  await Promise.all(\n    labels.map((label) =>\n      azureApiGit.createPullRequestLabel(\n        {\n          name: label,\n        },\n        config.repoId,\n        pr.pullRequestId\n      )\n    )\n  );\n  return getRenovatePRFormat(pr);\n}\n\nexport async function updatePr({\n  number: prNo,\n  prTitle: title,\n  prBody: body,\n  state,\n}: UpdatePrConfig): Promise<void> {\n  logger.debug(`updatePr(${prNo}, ${title}, body)`);\n\n  const azureApiGit = await azureApi.gitApi();\n  const objToUpdate: GitPullRequest = {\n    title,\n  };\n\n  if (body) {\n    objToUpdate.description = max4000Chars(sanitize(body));\n  }\n\n  if (state === PrState.Open) {\n    await azureApiGit.updatePullRequest(\n      { status: PullRequestStatus.Active },\n      config.repoId,\n      prNo\n    );\n  } else if (state === PrState.Closed) {\n    objToUpdate.status = PullRequestStatus.Abandoned;\n  }\n\n  await azureApiGit.updatePullRequest(objToUpdate, config.repoId, prNo);\n}\n\nexport async function ensureComment({\n  number,\n  topic,\n  content,\n}: EnsureCommentConfig): Promise<boolean> {\n  logger.debug(`ensureComment(${number}, ${topic}, content)`);\n  const header = topic ? `### ${topic}\\n\\n` : '';\n  const body = `${header}${sanitize(content)}`;\n  const azureApiGit = await azureApi.gitApi();\n\n  const threads = await azureApiGit.getThreads(config.repoId, number);\n  let threadIdFound = null;\n  let commentIdFound = null;\n  let commentNeedsUpdating = false;\n  threads.forEach((thread) => {\n    const firstCommentContent = thread.comments[0].content;\n    if (\n      (topic && firstCommentContent?.startsWith(header)) ||\n      (!topic && firstCommentContent === body)\n    ) {\n      threadIdFound = thread.id;\n      commentIdFound = thread.comments[0].id;\n      commentNeedsUpdating = firstCommentContent !== body;\n    }\n  });\n\n  if (!threadIdFound) {\n    await azureApiGit.createThread(\n      {\n        comments: [{ content: body, commentType: 1, parentCommentId: 0 }],\n        status: 1,\n      },\n      config.repoId,\n      number\n    );\n    logger.info(\n      { repository: config.repository, issueNo: number, topic },\n      'Comment added'\n    );\n  } else if (commentNeedsUpdating) {\n    await azureApiGit.updateComment(\n      {\n        content: body,\n      },\n      config.repoId,\n      number,\n      threadIdFound,\n      commentIdFound\n    );\n    logger.debug(\n      { repository: config.repository, issueNo: number, topic },\n      'Comment updated'\n    );\n  } else {\n    logger.debug(\n      { repository: config.repository, issueNo: number, topic },\n      'Comment is already update-to-date'\n    );\n  }\n\n  return true;\n}\n\nexport async function ensureCommentRemoval({\n  number: issueNo,\n  topic,\n  content,\n}: EnsureCommentRemovalConfig): Promise<void> {\n  logger.debug(\n    `Ensuring comment \"${topic || content}\" in #${issueNo} is removed`\n  );\n\n  const azureApiGit = await azureApi.gitApi();\n  const threads = await azureApiGit.getThreads(config.repoId, issueNo);\n\n  const byTopic = (thread: GitPullRequestCommentThread): boolean =>\n    thread.comments[0].content.startsWith(`### ${topic}\\n\\n`);\n  const byContent = (thread: GitPullRequestCommentThread): boolean =>\n    thread.comments[0].content.trim() === content;\n\n  let threadIdFound: number | null = null;\n\n  if (topic) {\n    threadIdFound = threads.find(byTopic)?.id;\n  } else if (content) {\n    threadIdFound = threads.find(byContent)?.id;\n  }\n\n  if (threadIdFound) {\n    await azureApiGit.updateThread(\n      {\n        status: 4, // close\n      },\n      config.repoId,\n      issueNo,\n      threadIdFound\n    );\n  }\n}\n\nconst renovateToAzureStatusMapping: Record<BranchStatus, GitStatusState> = {\n  [BranchStatus.green]: [GitStatusState.Succeeded],\n  [BranchStatus.green]: GitStatusState.Succeeded,\n  [BranchStatus.yellow]: GitStatusState.Pending,\n  [BranchStatus.red]: GitStatusState.Failed,\n};\n\nexport async function setBranchStatus({\n  branchName,\n  context,\n  description,\n  state,\n  url: targetUrl,\n}: BranchStatusConfig): Promise<void> {\n  logger.debug(\n    `setBranchStatus(${branchName}, ${context}, ${description}, ${state}, ${targetUrl})`\n  );\n  const azureApiGit = await azureApi.gitApi();\n  const branch = await azureApiGit.getBranch(\n    config.repoId,\n    getBranchNameWithoutRefsheadsPrefix(branchName)\n  );\n  const statusToCreate: GitStatus = {\n    description,\n    context: getGitStatusContextFromCombinedName(context),\n    state: renovateToAzureStatusMapping[state],\n    targetUrl,\n  };\n  await azureApiGit.createCommitStatus(\n    statusToCreate,\n    branch.commit.commitId,\n    config.repoId\n  );\n  logger.trace(`Created commit status of ${state} on branch ${branchName}`);\n}\n\nexport async function mergePr({\n  branchName,\n  id: pullRequestId,\n}: MergePRConfig): Promise<boolean> {\n  logger.debug(`mergePr(${pullRequestId}, ${branchName})`);\n  const azureApiGit = await azureApi.gitApi();\n\n  let pr = await azureApiGit.getPullRequestById(pullRequestId, config.project);\n\n  const mergeMethod =\n    config.mergeMethods[pr.targetRefName] ??\n    (config.mergeMethods[pr.targetRefName] = await azureHelper.getMergeMethod(\n      config.repoId,\n      config.project,\n      pr.targetRefName,\n      config.defaultBranch\n    ));\n\n  const objToUpdate: GitPullRequest = {\n    status: PullRequestStatus.Completed,\n    lastMergeSourceCommit: pr.lastMergeSourceCommit,\n    completionOptions: {\n      mergeStrategy: mergeMethod,\n      deleteSourceBranch: true,\n      mergeCommitMessage: pr.title,\n    },\n  };\n\n  logger.trace(\n    `Updating PR ${pullRequestId} to status ${PullRequestStatus.Completed} (${\n      PullRequestStatus[PullRequestStatus.Completed]\n    }) with lastMergeSourceCommit ${\n      pr.lastMergeSourceCommit.commitId\n    } using mergeStrategy ${mergeMethod} (${\n      GitPullRequestMergeStrategy[mergeMethod]\n    })`\n  );\n\n  try {\n    const response = await azureApiGit.updatePullRequest(\n      objToUpdate,\n      config.repoId,\n      pullRequestId\n    );\n\n    let retries = 0;\n    let isClosed = response.status === PullRequestStatus.Completed;\n    while (!isClosed && retries < 5) {\n      retries += 1;\n      const sleepMs = retries * 1000;\n      logger.trace(\n        { pullRequestId, status: pr.status, retries },\n        `Updated PR to closed status but change has not taken effect yet. Retrying...`\n      );\n\n      await delay(sleepMs);\n      pr = await azureApiGit.getPullRequestById(pullRequestId, config.project);\n      isClosed = pr.status === PullRequestStatus.Completed;\n    }\n\n    if (!isClosed) {\n      logger.warn(\n        { pullRequestId, status: pr.status },\n        `Expected PR to have status ${\n          PullRequestStatus[PullRequestStatus.Completed]\n        }, however it is ${PullRequestStatus[pr.status]}.`\n      );\n    }\n    return true;\n  } catch (err) {\n    logger.debug({ err }, 'Failed to set the PR as completed.');\n    return false;\n  }\n}\n\nexport function massageMarkdown(input: string): string {\n  // Remove any HTML we use\n  return smartTruncate(input, 4000)\n    .replace(\n      'you tick the rebase/retry checkbox',\n      'rename PR to start with \"rebase!\"'\n    )\n    .replace(regEx(`\\n---\\n\\n.*?<!-- rebase-check -->.*?\\n`), '');\n}\n\n/* istanbul ignore next */\nexport function findIssue(): Promise<Issue | null> {\n  logger.warn(`findIssue() is not implemented`);\n  return null;\n}\n\n/* istanbul ignore next */\nexport function ensureIssue(): Promise<EnsureIssueResult | null> {\n  logger.warn(`ensureIssue() is not implemented`);\n  return Promise.resolve(null);\n}\n\n/* istanbul ignore next */\nexport function ensureIssueClosing(): Promise<void> {\n  return Promise.resolve();\n}\n\n/* istanbul ignore next */\nexport function getIssueList(): Promise<Issue[]> {\n  logger.debug(`getIssueList()`);\n  // TODO: Needs implementation (#9592)\n  return Promise.resolve([]);\n}\n\nasync function getUserIds(users: string[]): Promise<User[]> {\n  const azureApiGit = await azureApi.gitApi();\n  const azureApiCore = await azureApi.coreApi();\n  const repos = await azureApiGit.getRepositories();\n  const repo = repos.filter((c) => c.id === config.repoId)[0];\n  const teams = await azureApiCore.getTeams(repo.project.id);\n  const members = await Promise.all(\n    teams.map(\n      async (t) =>\n        await azureApiCore.getTeamMembersWithExtendedProperties(\n          repo.project.id,\n          t.id\n        )\n    )\n  );\n\n  const ids: { id: string; name: string }[] = [];\n  members.forEach((listMembers) => {\n    listMembers.forEach((m) => {\n      users.forEach((r) => {\n        if (\n          r.toLowerCase() === m.identity.displayName.toLowerCase() ||\n          r.toLowerCase() === m.identity.uniqueName.toLowerCase()\n        ) {\n          if (ids.filter((c) => c.id === m.identity.id).length === 0) {\n            ids.push({ id: m.identity.id, name: r });\n          }\n        }\n      });\n    });\n  });\n\n  teams.forEach((t) => {\n    users.forEach((r) => {\n      if (r.toLowerCase() === t.name.toLowerCase()) {\n        if (ids.filter((c) => c.id === t.id).length === 0) {\n          ids.push({ id: t.id, name: r });\n        }\n      }\n    });\n  });\n\n  return ids;\n}\n\n/**\n *\n * @param {number} issueNo\n * @param {string[]} assignees\n */\nexport async function addAssignees(\n  issueNo: number,\n  assignees: string[]\n): Promise<void> {\n  logger.trace(`addAssignees(${issueNo}, [${assignees.join(', ')}])`);\n  const ids = await getUserIds(assignees);\n  await ensureComment({\n    number: issueNo,\n    topic: 'Add Assignees',\n    content: ids.map((a) => `@<${a.id}>`).join(', '),\n  });\n}\n\n/**\n *\n * @param {number} prNo\n * @param {string[]} reviewers\n */\nexport async function addReviewers(\n  prNo: number,\n  reviewers: string[]\n): Promise<void> {\n  logger.trace(`addReviewers(${prNo}, [${reviewers.join(', ')}])`);\n  const azureApiGit = await azureApi.gitApi();\n\n  const ids = await getUserIds(reviewers);\n\n  await Promise.all(\n    ids.map(async (obj) => {\n      await azureApiGit.createPullRequestReviewer(\n        {},\n        config.repoId,\n        prNo,\n        obj.id\n      );\n      logger.debug(`Reviewer added: ${obj.name}`);\n    })\n  );\n}\n\nexport async function deleteLabel(\n  prNumber: number,\n  label: string\n): Promise<void> {\n  logger.debug(`Deleting label ${label} from #${prNumber}`);\n  const azureApiGit = await azureApi.gitApi();\n  await azureApiGit.deletePullRequestLabels(config.repoId, prNumber, label);\n}\n\nexport function getVulnerabilityAlerts(): Promise<VulnerabilityAlert[]> {\n  return Promise.resolve([]);\n}\n"]}