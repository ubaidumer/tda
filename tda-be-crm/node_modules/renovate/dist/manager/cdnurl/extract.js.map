{"version":3,"file":"extract.js","sourceRoot":"","sources":["../../../lib/manager/cdnurl/extract.ts"],"names":[],"mappings":";;;AAAA,kDAAyD;AACzD,4CAAyC;AAG5B,QAAA,kBAAkB,GAAG,IAAA,aAAK,EACrC,iHAAiH,CAClH,CAAC;AAEF,SAAgB,kBAAkB,CAAC,OAAe;IAChD,MAAM,IAAI,GAAwB,EAAE,CAAC;IAErC,IAAI,IAAI,GAAG,OAAO,CAAC;IACnB,IAAI,KAAK,GAAG,0BAAkB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC1C,IAAI,MAAM,GAAG,CAAC,CAAC;IACf,OAAO,KAAK,EAAE;QACZ,MAAM,CAAC,WAAW,CAAC,GAAG,KAAK,CAAC;QAC5B,MAAM,EAAE,OAAO,EAAE,YAAY,EAAE,KAAK,EAAE,GAAG,KAAK,CAAC,MAAM,CAAC;QACtD,MAAM,IAAI,KAAK,CAAC,KAAK,GAAG,WAAW,CAAC,MAAM,CAAC;QAC3C,IAAI,GAAG,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;QAC7B,KAAK,GAAG,0BAAkB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAEtC,IAAI,CAAC,IAAI,CAAC;YACR,UAAU,EAAE,uBAAe,CAAC,EAAE;YAC9B,OAAO;YACP,UAAU,EAAE,GAAG,OAAO,IAAI,KAAK,EAAE;YACjC,YAAY;SACb,CAAC,CAAC;KACJ;IAED,OAAO,EAAE,IAAI,EAAE,CAAC;AAClB,CAAC;AAtBD,gDAsBC","sourcesContent":["import { CdnJsDatasource } from '../../datasource/cdnjs';\nimport { regEx } from '../../util/regex';\nimport type { PackageDependency, PackageFile } from '../types';\n\nexport const cloudflareUrlRegex = regEx(\n  /\\/\\/cdnjs\\.cloudflare\\.com\\/ajax\\/libs\\/(?<depName>[^/]+?)\\/(?<currentValue>[^/]+?)\\/(?<asset>[-/_.a-zA-Z0-9]+)/\n);\n\nexport function extractPackageFile(content: string): PackageFile {\n  const deps: PackageDependency[] = [];\n\n  let rest = content;\n  let match = cloudflareUrlRegex.exec(rest);\n  let offset = 0;\n  while (match) {\n    const [wholeSubstr] = match;\n    const { depName, currentValue, asset } = match.groups;\n    offset += match.index + wholeSubstr.length;\n    rest = content.slice(offset);\n    match = cloudflareUrlRegex.exec(rest);\n\n    deps.push({\n      datasource: CdnJsDatasource.id,\n      depName,\n      lookupName: `${depName}/${asset}`,\n      currentValue,\n    });\n  }\n\n  return { deps };\n}\n"]}