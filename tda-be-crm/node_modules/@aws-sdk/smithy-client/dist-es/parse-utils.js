import { __read } from "tslib";
export var parseBoolean = function (value) {
    switch (value) {
        case "true":
            return true;
        case "false":
            return false;
        default:
            throw new Error("Unable to parse boolean value \"" + value + "\"");
    }
};
export var expectBoolean = function (value) {
    if (value === null || value === undefined) {
        return undefined;
    }
    if (typeof value === "boolean") {
        return value;
    }
    throw new TypeError("Expected boolean, got " + typeof value);
};
export var expectNumber = function (value) {
    if (value === null || value === undefined) {
        return undefined;
    }
    if (typeof value === "number") {
        return value;
    }
    throw new TypeError("Expected number, got " + typeof value);
};
var MAX_FLOAT = Math.ceil(Math.pow(2, 127) * (2 - Math.pow(2, -23)));
export var expectFloat32 = function (value) {
    var expected = expectNumber(value);
    if (expected !== undefined && !Number.isNaN(expected) && expected !== Infinity && expected !== -Infinity) {
        if (Math.abs(expected) > MAX_FLOAT) {
            throw new TypeError("Expected 32-bit float, got " + value);
        }
    }
    return expected;
};
export var expectLong = function (value) {
    if (value === null || value === undefined) {
        return undefined;
    }
    if (Number.isInteger(value) && !Number.isNaN(value)) {
        return value;
    }
    throw new TypeError("Expected integer, got " + typeof value);
};
export var expectInt = expectLong;
export var expectInt32 = function (value) { return expectSizedInt(value, 32); };
export var expectShort = function (value) { return expectSizedInt(value, 16); };
export var expectByte = function (value) { return expectSizedInt(value, 8); };
var expectSizedInt = function (value, size) {
    var expected = expectLong(value);
    if (expected !== undefined && castInt(expected, size) !== expected) {
        throw new TypeError("Expected " + size + "-bit integer, got " + value);
    }
    return expected;
};
var castInt = function (value, size) {
    switch (size) {
        case 32:
            return Int32Array.of(value)[0];
        case 16:
            return Int16Array.of(value)[0];
        case 8:
            return Int8Array.of(value)[0];
    }
};
export var expectNonNull = function (value, location) {
    if (value === null || value === undefined) {
        if (location) {
            throw new TypeError("Expected a non-null value for " + location);
        }
        throw new TypeError("Expected a non-null value");
    }
    return value;
};
export var expectObject = function (value) {
    if (value === null || value === undefined) {
        return undefined;
    }
    if (typeof value === "object" && !Array.isArray(value)) {
        return value;
    }
    throw new TypeError("Expected object, got " + typeof value);
};
export var expectString = function (value) {
    if (value === null || value === undefined) {
        return undefined;
    }
    if (typeof value === "string") {
        return value;
    }
    throw new TypeError("Expected string, got " + typeof value);
};
export var expectUnion = function (value) {
    if (value === null || value === undefined) {
        return undefined;
    }
    var asObject = expectObject(value);
    var setKeys = Object.entries(asObject)
        .filter(function (_a) {
        var _b = __read(_a, 2), _ = _b[0], v = _b[1];
        return v !== null && v !== undefined;
    })
        .map(function (_a) {
        var _b = __read(_a, 2), k = _b[0], _ = _b[1];
        return k;
    });
    if (setKeys.length === 0) {
        throw new TypeError("Unions must have exactly one non-null member");
    }
    if (setKeys.length > 1) {
        throw new TypeError("Unions must have exactly one non-null member. Keys " + setKeys + " were not null.");
    }
    return asObject;
};
export var strictParseDouble = function (value) {
    if (typeof value == "string") {
        return expectNumber(parseNumber(value));
    }
    return expectNumber(value);
};
export var strictParseFloat = strictParseDouble;
export var strictParseFloat32 = function (value) {
    if (typeof value == "string") {
        return expectFloat32(parseNumber(value));
    }
    return expectFloat32(value);
};
var NUMBER_REGEX = /(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g;
var parseNumber = function (value) {
    var matches = value.match(NUMBER_REGEX);
    if (matches === null || matches[0].length !== value.length) {
        throw new TypeError("Expected real number, got implicit NaN");
    }
    return parseFloat(value);
};
export var limitedParseDouble = function (value) {
    if (typeof value == "string") {
        return parseFloatString(value);
    }
    return expectNumber(value);
};
export var handleFloat = limitedParseDouble;
export var limitedParseFloat = limitedParseDouble;
export var limitedParseFloat32 = function (value) {
    if (typeof value == "string") {
        return parseFloatString(value);
    }
    return expectFloat32(value);
};
var parseFloatString = function (value) {
    switch (value) {
        case "NaN":
            return NaN;
        case "Infinity":
            return Infinity;
        case "-Infinity":
            return -Infinity;
        default:
            throw new Error("Unable to parse float value: " + value);
    }
};
export var strictParseLong = function (value) {
    if (typeof value === "string") {
        return expectLong(parseNumber(value));
    }
    return expectLong(value);
};
export var strictParseInt = strictParseLong;
export var strictParseInt32 = function (value) {
    if (typeof value === "string") {
        return expectInt32(parseNumber(value));
    }
    return expectInt32(value);
};
export var strictParseShort = function (value) {
    if (typeof value === "string") {
        return expectShort(parseNumber(value));
    }
    return expectShort(value);
};
export var strictParseByte = function (value) {
    if (typeof value === "string") {
        return expectByte(parseNumber(value));
    }
    return expectByte(value);
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFyc2UtdXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvcGFyc2UtdXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQU1BLE1BQU0sQ0FBQyxJQUFNLFlBQVksR0FBRyxVQUFDLEtBQWE7SUFDeEMsUUFBUSxLQUFLLEVBQUU7UUFDYixLQUFLLE1BQU07WUFDVCxPQUFPLElBQUksQ0FBQztRQUNkLEtBQUssT0FBTztZQUNWLE9BQU8sS0FBSyxDQUFDO1FBQ2Y7WUFDRSxNQUFNLElBQUksS0FBSyxDQUFDLHFDQUFrQyxLQUFLLE9BQUcsQ0FBQyxDQUFDO0tBQy9EO0FBQ0gsQ0FBQyxDQUFDO0FBU0YsTUFBTSxDQUFDLElBQU0sYUFBYSxHQUFHLFVBQUMsS0FBVTtJQUN0QyxJQUFJLEtBQUssS0FBSyxJQUFJLElBQUksS0FBSyxLQUFLLFNBQVMsRUFBRTtRQUN6QyxPQUFPLFNBQVMsQ0FBQztLQUNsQjtJQUNELElBQUksT0FBTyxLQUFLLEtBQUssU0FBUyxFQUFFO1FBQzlCLE9BQU8sS0FBSyxDQUFDO0tBQ2Q7SUFDRCxNQUFNLElBQUksU0FBUyxDQUFDLDJCQUF5QixPQUFPLEtBQU8sQ0FBQyxDQUFDO0FBQy9ELENBQUMsQ0FBQztBQVNGLE1BQU0sQ0FBQyxJQUFNLFlBQVksR0FBRyxVQUFDLEtBQVU7SUFDckMsSUFBSSxLQUFLLEtBQUssSUFBSSxJQUFJLEtBQUssS0FBSyxTQUFTLEVBQUU7UUFDekMsT0FBTyxTQUFTLENBQUM7S0FDbEI7SUFDRCxJQUFJLE9BQU8sS0FBSyxLQUFLLFFBQVEsRUFBRTtRQUM3QixPQUFPLEtBQUssQ0FBQztLQUNkO0lBQ0QsTUFBTSxJQUFJLFNBQVMsQ0FBQywwQkFBd0IsT0FBTyxLQUFPLENBQUMsQ0FBQztBQUM5RCxDQUFDLENBQUM7QUFFRixJQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQUEsQ0FBQyxFQUFJLEdBQUcsQ0FBQSxHQUFHLENBQUMsQ0FBQyxHQUFH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QUFlLEdBQUcsVUFBQyxLQUFzQjtJQUNwRCxJQUFJLE9BQU8sS0FBSyxLQUFLLFFBQVEsRUFBRTtRQUc3QixPQUFPLFVBQVUsQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztLQUN2QztJQUNELE9BQU8sVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQzNCLENBQUMsQ0FBQztBQUtGLE1BQU0sQ0FBQyxJQUFNLGNBQWMsR0FBRyxlQUFlLENBQUM7QUFZOUMsTUFBTSxDQUFDLElBQU0sZ0JBQWdCLEdBQUcsVUFBQyxLQUFzQjtJQUNyRCxJQUFJLE9BQU8sS0FBSyxLQUFLLFFBQVEsRUFBRTtRQUc3QixPQUFPLFdBQVcsQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztLQUN4QztJQUNELE9BQU8sV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQzVCLENBQUMsQ0FBQztBQVlGLE1BQU0sQ0FBQyxJQUFNLGdCQUFnQixHQUFHLFVBQUMsS0FBc0I7SUFDckQsSUFBSSxPQUFPLEtBQUssS0FBSyxRQUFRLEVBQUU7UUFHN0IsT0FBTyxXQUFXLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7S0FDeEM7SUFDRCxPQUFPLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUM1QixDQUFDLENBQUM7QUFZRixNQUFNLENBQUMsSUFBTSxlQUFlLEdBQUcsVUFBQyxLQUFzQjtJQUNwRCxJQUFJLE9BQU8sS0FBSyxLQUFLLFFBQVEsRUFBRTtRQUc3QixPQUFPLFVBQVUsQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztLQUN2QztJQUNELE9BQU8sVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQzNCLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogR2l2ZSBhbiBpbnB1dCBzdHJpbmcsIHN0cmljdGx5IHBhcnNlcyBhIGJvb2xlYW4gdmFsdWUuXG4gKlxuICogQHBhcmFtIHZhbHVlIFRoZSBib29sZWFuIHN0cmluZyB0byBwYXJzZS5cbiAqIEByZXR1cm5zIHRydWUgZm9yIFwidHJ1ZVwiLCBmYWxzZSBmb3IgXCJmYWxzZVwiLCBvdGhlcndpc2UgYW4gZXJyb3IgaXMgdGhyb3duLlxuICovXG5leHBvcnQgY29uc3QgcGFyc2VCb29sZWFuID0gKHZhbHVlOiBzdHJpbmcpOiBib29sZWFuID0+IHtcbiAgc3dpdGNoICh2YWx1ZSkge1xuICAgIGNhc2UgXCJ0cnVlXCI6XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICBjYXNlIFwiZmFsc2VcIjpcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICBkZWZhdWx0OlxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmFibGUgdG8gcGFyc2UgYm9vbGVhbiB2YWx1ZSBcIiR7dmFsdWV9XCJgKTtcbiAgfVxufTtcblxuLypcbiAqIEFzc2VydHMgYSB2YWx1ZSBpcyBhIGJvb2xlYW4gYW5kIHJldHVybnMgaXQuXG4gKlxuICogQHBhcmFtIHZhbHVlIEEgdmFsdWUgdGhhdCBpcyBleHBlY3RlZCB0byBiZSBhIGJvb2xlYW4uXG4gKiBAcmV0dXJucyBUaGUgdmFsdWUgaWYgaXQncyBhIGJvb2xlYW4sIHVuZGVmaW5lZCBpZiBpdCdzIG51bGwvdW5kZWZpbmVkLFxuICogICBvdGhlcndpc2UgYW4gZXJyb3IgaXMgdGhyb3duLlxuICovXG5leHBvcnQgY29uc3QgZXhwZWN0Qm9vbGVhbiA9ICh2YWx1ZTogYW55KTogYm9vbGVhbiB8IHVuZGVmaW5lZCA9PiB7XG4gIGlmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICBpZiAodHlwZW9mIHZhbHVlID09PSBcImJvb2xlYW5cIikge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuICB0aHJvdyBuZXcgVHlwZUVycm9yKGBFeHBlY3RlZCBib29sZWFuLCBnb3QgJHt0eXBlb2YgdmFsdWV9YCk7XG59O1xuXG4vKipcbiAqIEFzc2VydHMgYSB2YWx1ZSBpcyBhIG51bWJlciBhbmQgcmV0dXJucyBpdC5cbiAqXG4gKiBAcGFyYW0gdmFsdWUgQSB2YWx1ZSB0aGF0IGlzIGV4cGVjdGVkIHRvIGJlIGEgbnVtYmVyLlxuICogQHJldHVybnMgVGhlIHZhbHVlIGlmIGl0J3MgYSBudW1iZXIsIHVuZGVmaW5lZCBpZiBpdCdzIG51bGwvdW5kZWZpbmVkLFxuICogICBvdGhlcndpc2UgYW4gZXJyb3IgaXMgdGhyb3duLlxuICovXG5leHBvcnQgY29uc3QgZXhwZWN0TnVtYmVyID0gKHZhbHVlOiBhbnkpOiBudW1iZXIgfCB1bmRlZmluZWQgPT4ge1xuICBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIikge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuICB0aHJvdyBuZXcgVHlwZUVycm9yKGBFeHBlY3RlZCBudW1iZXIsIGdvdCAke3R5cGVvZiB2YWx1ZX1gKTtcbn07XG5cbmNvbnN0IE1BWF9GTE9BVCA9IE1hdGguY2VpbCgyICoqIDEyNyAqICgyIC0gMiAqKiAtMjMpKTtcblxuLyoqXG4gKiBBc3NlcnRzIGEgdmFsdWUgaXMgYSAzMi1iaXQgZmxvYXQgYW5kIHJldHVybnMgaXQuXG4gKlxuICogQHBhcmFtIHZhbHVlIEEgdmFsdWUgdGhhdCBpcyBleHBlY3RlZCB0byBiZSBhIDMyLWJpdCBmbG9hdC5cbiAqIEByZXR1cm5zIFRoZSB2YWx1ZSBpZiBpdCdzIGEgZmxvYXQsIHVuZGVmaW5lZCBpZiBpdCdzIG51bGwvdW5kZWZpbmVkLFxuICogICBvdGhlcndpc2UgYW4gZXJyb3IgaXMgdGhyb3duLlxuICovXG5leHBvcnQgY29uc3QgZXhwZWN0RmxvYXQzMiA9ICh2YWx1ZTogYW55KTogbnVtYmVyIHwgdW5kZWZpbmVkID0+IHtcbiAgY29uc3QgZXhwZWN0ZWQgPSBleHBlY3ROdW1iZXIodmFsdWUpO1xuICBpZiAoZXhwZWN0ZWQgIT09IHVuZGVmaW5lZCAmJiAhTnVtYmVyLmlzTmFOKGV4cGVjdGVkKSAmJiBleHBlY3RlZCAhPT0gSW5maW5pdHkgJiYgZXhwZWN0ZWQgIT09IC1JbmZpbml0eSkge1xuICAgIC8vIElFRUUtNzU0IGlzIGFuIGltcGVyZmVjdCByZXByZXNlbnRhdGlvbiBmb3IgZmxvYXRzLiBDb25zaWRlciB0aGUgc2ltcGxlXG4gICAgLy8gdmFsdWUgYDAuMWAuIFRoZSByZXByZXNlbnRhdGlvbiBpbiBhIDMyLWJpdCBmbG9hdCB3b3VsZCBsb29rIGxpa2U6XG4gICAgLy9cbiAgICAvLyAwIDAxMTExMDExIDEwMDExMDAxMTAwMTEwMDExMDAxMTAxXG4gICAgLy8gQWN0dWFsIHZhbHVlOiAwLjEwMDAwMDAwMTQ5MDExNjExOTM4NDc2NTYyNVxuICAgIC8vXG4gICAgLy8gTm90ZSB0aGUgcmVwZWF0aW5nIHBhdHRlcm4gb2YgYDEwMDFgIGluIHRoZSBmcmFjdGlvbiBwYXJ0LiBUaGUgNjQtYml0XG4gICAgLy8gcmVwcmVzZW50YXRpb24gaXMgc2ltaWxhcjpcbiAgICAvL1xuICAgIC8vIDAgMDExMTExMTEwMTEgMTAwMTEwMDExMDAxMTAwMTEwMDExMDAxMTAwMTEwMDExMDAxMTAwMTEwMDExMDAxMTAxMFxuICAgIC8vIEFjdHVhbCB2YWx1ZTogMC4xMDAwMDAwMDAwMDAwMDAwMDU1NTExMTUxMjMxMjZcbiAgICAvL1xuICAgIC8vIFNvIGV2ZW4gZm9yIHdoYXQgd2UgY29uc2lkZXIgc2ltcGxlIG51bWJlcnMsIHRoZSByZXByZXNlbnRhdGlvbiBkaWZmZXJzXG4gICAgLy8gYmV0d2VlbiB0aGUgdHdvIGZvcm1hdHMuIEFuZCBpdCdzIG5vbi1vYnZpb3VzIGhvdyBvbmUgbWlnaHQgbG9vayBhdCB0aGVcbiAgICAvLyA2NC1iaXQgdmFsdWUgKHdoaWNoIGlzIGhvdyBKUyByZXByZXNlbnRzIG51bWJlcnMpIGFuZCBkZXRlcm1pbmUgaWYgaXRcbiAgICAvLyBjYW4gYmUgcmVwcmVzZW50ZWQgcmVhc29uYWJseSBpbiB0aGUgMzItYml0IGZvcm0uIFByaW1hcmlseSBiZWNhdXNlIHlvdVxuICAgIC8vIGNhbid0IGtub3cgd2hldGhlciB0aGUgaW50ZW50IHdhcyB0byByZXByZXNlbnQgYDAuMWAgb3IgdGhlIGFjdHVhbFxuICAgIC8vIHZhbHVlIGluIG1lbW9yeS4gQnV0IGV2ZW4gaWYgeW91IGhhdmUgYm90aCB0aGUgZGVjaW1hbCB2YWx1ZSBhbmQgdGhlXG4gICAgLy8gZG91YmxlIHZhbHVlLCB0aGF0IHN0aWxsIGRvZXNuJ3QgY29tbXVuaWNhdGUgdGhlIGludGVuZGVkIHByZWNpc2lvbi5cbiAgICAvL1xuICAgIC8vIFNvIHJhdGhlciB0aGFuIGF0dGVtcHRpbmcgdG8gZGl2aW5lIHRoZSBpbnRlbnQgb2YgdGhlIGNhbGxlciwgd2UgaW5zdGVhZFxuICAgIC8vIGRvIHNvbWUgc2ltcGxlIGJvdW5kcyBjaGVja2luZyB0byBtYWtlIHN1cmUgdGhlIHZhbHVlIGlzIHBhc3NpbmdseVxuICAgIC8vIHJlcHJlc2VudGFibGUgaW4gYSAzMi1iaXQgZmxvYXQuIEl0J3Mgbm90IHBlcmZlY3QsIGJ1dCBpdCdzIGdvb2QgZW5vdWdoLlxuICAgIC8vIFBlcmZlY3QsIGV2ZW4gaWYgcG9zc2libGUgdG8gYWNoaWV2ZSwgd291bGQgbGlrZWx5IGJlIHRvbyBjb3N0bHkgdG9cbiAgICAvLyBiZSB3b3J0aCBpdC5cbiAgICAvL1xuICAgIC8vIFRoZSBtYXhpbXVtIHZhbHVlIG9mIGEgMzItYml0IGZsb2F0LiBTaW5jZSB0aGUgNjQtYml0IHJlcHJlc2VudGF0aW9uXG4gICAgLy8gY291bGQgYmUgbW9yZSBvciBsZXNzLCB3ZSBqdXN0IHJvdW5kIGl0IHVwIHRvIHRoZSBuZWFyZXN0IHdob2xlIG51bWJlci5cbiAgICAvLyBUaGlzIGZ1cnRoZXIgcmVkdWNlcyBvdXIgYWJpbGl0eSB0byBiZSBjZXJ0YWluIG9mIHRoZSB2YWx1ZSwgYnV0IGl0J3NcbiAgICAvLyBhbiBhY2NlcHRhYmxlIHRyYWRlb2ZmLlxuICAgIC8vXG4gICAgLy8gQ29tcGFyZSBhZ2FpbnN0IHRoZSBhYnNvbHV0ZSB2YWx1ZSB0byBzaW1wbGlmeSB0aGluZ3MuXG4gICAgaWYgKE1hdGguYWJzKGV4cGVjdGVkKSA+IE1BWF9GTE9BVCkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgRXhwZWN0ZWQgMzItYml0IGZsb2F0LCBnb3QgJHt2YWx1ZX1gKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGV4cGVjdGVkO1xufTtcblxuLyoqXG4gKiBBc3NlcnRzIGEgdmFsdWUgaXMgYW4gaW50ZWdlciBhbmQgcmV0dXJucyBpdC5cbiAqXG4gKiBAcGFyYW0gdmFsdWUgQSB2YWx1ZSB0aGF0IGlzIGV4cGVjdGVkIHRvIGJlIGFuIGludGVnZXIuXG4gKiBAcmV0dXJucyBUaGUgdmFsdWUgaWYgaXQncyBhbiBpbnRlZ2VyLCB1bmRlZmluZWQgaWYgaXQncyBudWxsL3VuZGVmaW5lZCxcbiAqICAgb3RoZXJ3aXNlIGFuIGVycm9yIGlzIHRocm93bi5cbiAqL1xuZXhwb3J0IGNvbnN0IGV4cGVjdExvbmcgPSAodmFsdWU6IGFueSk6IG51bWJlciB8IHVuZGVmaW5lZCA9PiB7XG4gIGlmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICBpZiAoTnVtYmVyLmlzSW50ZWdlcih2YWx1ZSkgJiYgIU51bWJlci5pc05hTih2YWx1ZSkpIHtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cbiAgdGhyb3cgbmV3IFR5cGVFcnJvcihgRXhwZWN0ZWQgaW50ZWdlciwgZ290ICR7dHlwZW9mIHZhbHVlfWApO1xufTtcblxuLyoqXG4gKiBAZGVwcmVjYXRlZCBVc2UgZXhwZWN0TG9uZ1xuICovXG5leHBvcnQgY29uc3QgZXhwZWN0SW50ID0gZXhwZWN0TG9uZztcblxuLyoqXG4gKiBBc3NlcnRzIGEgdmFsdWUgaXMgYSAzMi1iaXQgaW50ZWdlciBhbmQgcmV0dXJucyBpdC5cbiAqXG4gKiBAcGFyYW0gdmFsdWUgQSB2YWx1ZSB0aGF0IGlzIGV4cGVjdGVkIHRvIGJlIGFuIGludGVnZXIuXG4gKiBAcmV0dXJucyBUaGUgdmFsdWUgaWYgaXQncyBhbiBpbnRlZ2VyLCB1bmRlZmluZWQgaWYgaXQncyBudWxsL3VuZGVmaW5lZCxcbiAqICAgb3RoZXJ3aXNlIGFuIGVycm9yIGlzIHRocm93bi5cbiAqL1xuZXhwb3J0IGNvbnN0IGV4cGVjdEludDMyID0gKHZhbHVlOiBhbnkpOiBudW1iZXIgfCB1bmRlZmluZWQgPT4gZXhwZWN0U2l6ZWRJbnQodmFsdWUsIDMyKTtcblxuLyoqXG4gKiBBc3NlcnRzIGEgdmFsdWUgaXMgYSAxNi1iaXQgaW50ZWdlciBhbmQgcmV0dXJucyBpdC5cbiAqXG4gKiBAcGFyYW0gdmFsdWUgQSB2YWx1ZSB0aGF0IGlzIGV4cGVjdGVkIHRvIGJlIGFuIGludGVnZXIuXG4gKiBAcmV0dXJucyBUaGUgdmFsdWUgaWYgaXQncyBhbiBpbnRlZ2VyLCB1bmRlZmluZWQgaWYgaXQncyBudWxsL3VuZGVmaW5lZCxcbiAqICAgb3RoZXJ3aXNlIGFuIGVycm9yIGlzIHRocm93bi5cbiAqL1xuZXhwb3J0IGNvbnN0IGV4cGVjdFNob3J0ID0gKHZhbHVlOiBhbnkpOiBudW1iZXIgfCB1bmRlZmluZWQgPT4gZXhwZWN0U2l6ZWRJbnQodmFsdWUsIDE2KTtcblxuLyoqXG4gKiBBc3NlcnRzIGEgdmFsdWUgaXMgYW4gOC1iaXQgaW50ZWdlciBhbmQgcmV0dXJucyBpdC5cbiAqXG4gKiBAcGFyYW0gdmFsdWUgQSB2YWx1ZSB0aGF0IGlzIGV4cGVjdGVkIHRvIGJlIGFuIGludGVnZXIuXG4gKiBAcmV0dXJucyBUaGUgdmFsdWUgaWYgaXQncyBhbiBpbnRlZ2VyLCB1bmRlZmluZWQgaWYgaXQncyBudWxsL3VuZGVmaW5lZCxcbiAqICAgb3RoZXJ3aXNlIGFuIGVycm9yIGlzIHRocm93bi5cbiAqL1xuZXhwb3J0IGNvbnN0IGV4cGVjdEJ5dGUgPSAodmFsdWU6IGFueSk6IG51bWJlciB8IHVuZGVmaW5lZCA9PiBleHBlY3RTaXplZEludCh2YWx1ZSwgOCk7XG5cbnR5cGUgSW50U2l6ZSA9IDMyIHwgMTYgfCA4O1xuXG5jb25zdCBleHBlY3RTaXplZEludCA9ICh2YWx1ZTogYW55LCBzaXplOiBJbnRTaXplKTogbnVtYmVyIHwgdW5kZWZpbmVkID0+IHtcbiAgY29uc3QgZXhwZWN0ZWQgPSBleHBlY3RMb25nKHZhbHVlKTtcbiAgaWYgKGV4cGVjdGVkICE9PSB1bmRlZmluZWQgJiYgY2FzdEludChleHBlY3RlZCwgc2l6ZSkgIT09IGV4cGVjdGVkKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgRXhwZWN0ZWQgJHtzaXplfS1iaXQgaW50ZWdlciwgZ290ICR7dmFsdWV9YCk7XG4gIH1cbiAgcmV0dXJuIGV4cGVjdGVkO1xufTtcblxuY29uc3QgY2FzdEludCA9ICh2YWx1ZTogbnVtYmVyLCBzaXplOiBJbnRTaXplKSA9PiB7XG4gIHN3aXRjaCAoc2l6ZSkge1xuICAgIGNhc2UgMzI6XG4gICAgICByZXR1cm4gSW50MzJBcnJheS5vZih2YWx1ZSlbMF07XG4gICAgY2FzZSAxNjpcbiAgICAgIHJldHVybiBJbnQxNkFycmF5Lm9mKHZhbHVlKVswXTtcbiAgICBjYXNlIDg6XG4gICAgICByZXR1cm4gSW50OEFycmF5Lm9mKHZhbHVlKVswXTtcbiAgfVxufTtcblxuLyoqXG4gKiBBc3NlcnRzIGEgdmFsdWUgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkIGFuZCByZXR1cm5zIGl0LCBvciB0aHJvd3MgYW4gZXJyb3IuXG4gKlxuICogQHBhcmFtIHZhbHVlIEEgdmFsdWUgdGhhdCBpcyBleHBlY3RlZCB0byBiZSBkZWZpbmVkXG4gKiBAcGFyYW0gbG9jYXRpb24gVGhlIGxvY2F0aW9uIHdoZXJlIHdlJ3JlIGV4cGVjdGluZyB0byBmaW5kIGEgZGVmaW5lZCBvYmplY3QgKG9wdGlvbmFsKVxuICogQHJldHVybnMgVGhlIHZhbHVlIGlmIGl0J3Mgbm90IHVuZGVmaW5lZCwgb3RoZXJ3aXNlIHRocm93cyBhbiBlcnJvclxuICovXG5leHBvcnQgY29uc3QgZXhwZWN0Tm9uTnVsbCA9IDxUPih2YWx1ZTogVCB8IG51bGwgfCB1bmRlZmluZWQsIGxvY2F0aW9uPzogc3RyaW5nKTogVCA9PiB7XG4gIGlmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgaWYgKGxvY2F0aW9uKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGBFeHBlY3RlZCBhIG5vbi1udWxsIHZhbHVlIGZvciAke2xvY2F0aW9ufWApO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRXhwZWN0ZWQgYSBub24tbnVsbCB2YWx1ZVwiKTtcbiAgfVxuICByZXR1cm4gdmFsdWU7XG59O1xuXG4vKipcbiAqIEFzc2VydHMgYSB2YWx1ZSBpcyBhbiBKU09OLWxpa2Ugb2JqZWN0IGFuZCByZXR1cm5zIGl0LiBUaGlzIGlzIGV4cGVjdGVkIHRvIGJlIHVzZWRcbiAqIHdpdGggdmFsdWVzIHBhcnNlZCBmcm9tIEpTT04gKGFycmF5cywgb2JqZWN0cywgbnVtYmVycywgc3RyaW5ncywgYm9vbGVhbnMpLlxuICpcbiAqIEBwYXJhbSB2YWx1ZSBBIHZhbHVlIHRoYXQgaXMgZXhwZWN0ZWQgdG8gYmUgYW4gb2JqZWN0XG4gKiBAcmV0dXJucyBUaGUgdmFsdWUgaWYgaXQncyBhbiBvYmplY3QsIHVuZGVmaW5lZCBpZiBpdCdzIG51bGwvdW5kZWZpbmVkLFxuICogICBvdGhlcndpc2UgYW4gZXJyb3IgaXMgdGhyb3duLlxuICovXG5leHBvcnQgY29uc3QgZXhwZWN0T2JqZWN0ID0gKHZhbHVlOiBhbnkpOiB7IFtrZXk6IHN0cmluZ106IGFueSB9IHwgdW5kZWZpbmVkID0+IHtcbiAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG4gIGlmICh0eXBlb2YgdmFsdWUgPT09IFwib2JqZWN0XCIgJiYgIUFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG4gIHRocm93IG5ldyBUeXBlRXJyb3IoYEV4cGVjdGVkIG9iamVjdCwgZ290ICR7dHlwZW9mIHZhbHVlfWApO1xufTtcblxuLyoqXG4gKiBBc3NlcnRzIGEgdmFsdWUgaXMgYSBzdHJpbmcgYW5kIHJldHVybnMgaXQuXG4gKlxuICogQHBhcmFtIHZhbHVlIEEgdmFsdWUgdGhhdCBpcyBleHBlY3RlZCB0byBiZSBhIHN0cmluZy5cbiAqIEByZXR1cm5zIFRoZSB2YWx1ZSBpZiBpdCdzIGEgc3RyaW5nLCB1bmRlZmluZWQgaWYgaXQncyBudWxsL3VuZGVmaW5lZCxcbiAqICAgb3RoZXJ3aXNlIGFuIGVycm9yIGlzIHRocm93bi5cbiAqL1xuZXhwb3J0IGNvbnN0IGV4cGVjdFN0cmluZyA9ICh2YWx1ZTogYW55KTogc3RyaW5nIHwgdW5kZWZpbmVkID0+IHtcbiAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG4gIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cbiAgdGhyb3cgbmV3IFR5cGVFcnJvcihgRXhwZWN0ZWQgc3RyaW5nLCBnb3QgJHt0eXBlb2YgdmFsdWV9YCk7XG59O1xuXG4vKipcbiAqIEFzc2VydHMgYSB2YWx1ZSBpcyBhIEpTT04tbGlrZSBvYmplY3Qgd2l0aCBvbmx5IG9uZSBub24tbnVsbC9ub24tdW5kZWZpbmVkIGtleSBhbmRcbiAqIHJldHVybnMgaXQuXG4gKlxuICogQHBhcmFtIHZhbHVlIEEgdmFsdWUgdGhhdCBpcyBleHBlY3RlZCB0byBiZSBhbiBvYmplY3Qgd2l0aCBleGFjdGx5IG9uZSBub24tbnVsbCxcbiAqICAgICAgICAgICAgICBub24tdW5kZWZpbmVkIGtleS5cbiAqIEByZXR1cm4gdGhlIHZhbHVlIGlmIGl0J3MgYSB1bmlvbiwgdW5kZWZpbmVkIGlmIGl0J3MgbnVsbC91bmRlZmluZWQsIG90aGVyd2lzZVxuICogIGFuIGVycm9yIGlzIHRocm93bi5cbiAqL1xuZXhwb3J0IGNvbnN0IGV4cGVjdFVuaW9uID0gKHZhbHVlOiB1bmtub3duKTogeyBba2V5OiBzdHJpbmddOiBhbnkgfSB8IHVuZGVmaW5lZCA9PiB7XG4gIGlmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICBjb25zdCBhc09iamVjdCA9IGV4cGVjdE9iamVjdCh2YWx1ZSkhO1xuXG4gIGNvbnN0IHNldEtleXMgPSBPYmplY3QuZW50cmllcyhhc09iamVjdClcbiAgICAuZmlsdGVyKChbXywgdl0pID0+IHYgIT09IG51bGwgJiYgdiAhPT0gdW5kZWZpbmVkKVxuICAgIC5tYXAoKFtrLCBfXSkgPT4gayk7XG5cbiAgaWYgKHNldEtleXMubGVuZ3RoID09PSAwKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgVW5pb25zIG11c3QgaGF2ZSBleGFjdGx5IG9uZSBub24tbnVsbCBtZW1iZXJgKTtcbiAgfVxuXG4gIGlmIChzZXRLZXlzLmxlbmd0aCA+IDEpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGBVbmlvbnMgbXVzdCBoYXZlIGV4YWN0bHkgb25lIG5vbi1udWxsIG1lbWJlci4gS2V5cyAke3NldEtleXN9IHdlcmUgbm90IG51bGwuYCk7XG4gIH1cblxuICByZXR1cm4gYXNPYmplY3Q7XG59O1xuXG4vKipcbiAqIFBhcnNlcyBhIHZhbHVlIGludG8gYSBkb3VibGUuIElmIHRoZSB2YWx1ZSBpcyBudWxsIG9yIHVuZGVmaW5lZCwgdW5kZWZpbmVkXG4gKiB3aWxsIGJlIHJldHVybmVkLiBJZiB0aGUgdmFsdWUgaXMgYSBzdHJpbmcsIGl0IHdpbGwgYmUgcGFyc2VkIGJ5IHRoZSBzdGFuZGFyZFxuICogcGFyc2VGbG9hdCB3aXRoIG9uZSBleGNlcHRpb246IE5hTiBtYXkgb25seSBiZSBleHBsaWNpdGx5IHNldCBhcyB0aGUgc3RyaW5nXG4gKiBcIk5hTlwiLCBhbnkgaW1wbGljaXQgTmFuIHZhbHVlcyB3aWxsIHJlc3VsdCBpbiBhbiBlcnJvciBiZWluZyB0aHJvd24uIElmIGFueVxuICogb3RoZXIgdHlwZSBpcyBwcm92aWRlZCwgYW4gZXhjZXB0aW9uIHdpbGwgYmUgdGhyb3duLlxuICpcbiAqIEBwYXJhbSB2YWx1ZSBBIG51bWJlciBvciBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBkb3VibGUuXG4gKiBAcmV0dXJucyBUaGUgdmFsdWUgYXMgYSBudW1iZXIsIG9yIHVuZGVmaW5lZCBpZiBpdCdzIG51bGwvdW5kZWZpbmVkLlxuICovXG5leHBvcnQgY29uc3Qgc3RyaWN0UGFyc2VEb3VibGUgPSAodmFsdWU6IHN0cmluZyB8IG51bWJlcik6IG51bWJlciB8IHVuZGVmaW5lZCA9PiB7XG4gIGlmICh0eXBlb2YgdmFsdWUgPT0gXCJzdHJpbmdcIikge1xuICAgIHJldHVybiBleHBlY3ROdW1iZXIocGFyc2VOdW1iZXIodmFsdWUpKTtcbiAgfVxuICByZXR1cm4gZXhwZWN0TnVtYmVyKHZhbHVlKTtcbn07XG5cbi8qKlxuICogQGRlcHJlY2F0ZWQgVXNlIHN0cmljdFBhcnNlRG91YmxlXG4gKi9cbmV4cG9ydCBjb25zdCBzdHJpY3RQYXJzZUZsb2F0ID0gc3RyaWN0UGFyc2VEb3VibGU7XG5cbi8qKlxuICogUGFyc2VzIGEgdmFsdWUgaW50byBhIGZsb2F0LiBJZiB0aGUgdmFsdWUgaXMgbnVsbCBvciB1bmRlZmluZWQsIHVuZGVmaW5lZFxuICogd2lsbCBiZSByZXR1cm5lZC4gSWYgdGhlIHZhbHVlIGlzIGEgc3RyaW5nLCBpdCB3aWxsIGJlIHBhcnNlZCBieSB0aGUgc3RhbmRhcmRcbiAqIHBhcnNlRmxvYXQgd2l0aCBvbmUgZXhjZXB0aW9uOiBOYU4gbWF5IG9ubHkgYmUgZXhwbGljaXRseSBzZXQgYXMgdGhlIHN0cmluZ1xuICogXCJOYU5cIiwgYW55IGltcGxpY2l0IE5hbiB2YWx1ZXMgd2lsbCByZXN1bHQgaW4gYW4gZXJyb3IgYmVpbmcgdGhyb3duLiBJZiBhbnlcbiAqIG90aGVyIHR5cGUgaXMgcHJvdmlkZWQsIGFuIGV4Y2VwdGlvbiB3aWxsIGJlIHRocm93bi5cbiAqXG4gKiBAcGFyYW0gdmFsdWUgQSBudW1iZXIgb3Igc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGEgZmxvYXQuXG4gKiBAcmV0dXJucyBUaGUgdmFsdWUgYXMgYSBudW1iZXIsIG9yIHVuZGVmaW5lZCBpZiBpdCdzIG51bGwvdW5kZWZpbmVkLlxuICovXG5leHBvcnQgY29uc3Qgc3RyaWN0UGFyc2VGbG9hdDMyID0gKHZhbHVlOiBzdHJpbmcgfCBudW1iZXIpOiBudW1iZXIgfCB1bmRlZmluZWQgPT4ge1xuICBpZiAodHlwZW9mIHZhbHVlID09IFwic3RyaW5nXCIpIHtcbiAgICByZXR1cm4gZXhwZWN0RmxvYXQzMihwYXJzZU51bWJlcih2YWx1ZSkpO1xuICB9XG4gIHJldHVybiBleHBlY3RGbG9hdDMyKHZhbHVlKTtcbn07XG5cbi8vIFRoaXMgcmVnZXggbWF0Y2hlcyBKU09OLXN0eWxlIG51bWJlcnMuIEluIHNob3J0OlxuLy8gKiBUaGUgaW50ZWdyYWwgbWF5IHN0YXJ0IHdpdGggYSBuZWdhdGl2ZSBzaWduLCBidXQgbm90IGEgcG9zaXRpdmUgb25lXG4vLyAqIE5vIGxlYWRpbmcgMCBvbiB0aGUgaW50ZWdyYWwgdW5sZXNzIGl0J3MgaW1tZWRpYXRlbHkgZm9sbG93ZWQgYnkgYSAnLidcbi8vICogRXhwb25lbnQgaW5kaWNhdGVkIGJ5IGEgY2FzZS1pbnNlbnNpdGl2ZSAnRScgb3B0aW9uYWxseSBmb2xsb3dlZCBieSBhXG4vLyAgIHBvc2l0aXZlL25lZ2F0aXZlIHNpZ24gYW5kIHNvbWUgbnVtYmVyIG9mIGRpZ2l0cy5cbi8vIEl0IGFsc28gbWF0Y2hlcyBib3RoIHBvc2l0aXZlIGFuZCBuZWdhdGl2ZSBpbmZpbml0eSBhcyB3ZWxsIGFuZCBleHBsaWNpdCBOYU4uXG5jb25zdCBOVU1CRVJfUkVHRVggPSAvKC0/KD86MHxbMS05XVxcZCopKD86XFwuXFxkKyk/KD86W2VFXVsrLV0/XFxkKyk/KXwoLT9JbmZpbml0eSl8KE5hTikvZztcblxuY29uc3QgcGFyc2VOdW1iZXIgPSAodmFsdWU6IHN0cmluZyk6IG51bWJlciA9PiB7XG4gIGNvbnN0IG1hdGNoZXMgPSB2YWx1ZS5tYXRjaChOVU1CRVJfUkVHRVgpO1xuICBpZiAobWF0Y2hlcyA9PT0gbnVsbCB8fCBtYXRjaGVzWzBdLmxlbmd0aCAhPT0gdmFsdWUubGVuZ3RoKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgRXhwZWN0ZWQgcmVhbCBudW1iZXIsIGdvdCBpbXBsaWNpdCBOYU5gKTtcbiAgfVxuICByZXR1cm4gcGFyc2VGbG9hdCh2YWx1ZSk7XG59O1xuXG4vKipcbiAqIEFzc2VydHMgYSB2YWx1ZSBpcyBhIG51bWJlciBhbmQgcmV0dXJucyBpdC4gSWYgdGhlIHZhbHVlIGlzIGEgc3RyaW5nXG4gKiByZXByZXNlbnRhdGlvbiBvZiBhIG5vbi1udW1lcmljIG51bWJlciB0eXBlIChOYU4sIEluZmluaXR5LCAtSW5maW5pdHkpLFxuICogdGhlIHZhbHVlIHdpbGwgYmUgcGFyc2VkLiBBbnkgb3RoZXIgc3RyaW5nIHZhbHVlIHdpbGwgcmVzdWx0IGluIGFuIGV4Y2VwdGlvblxuICogYmVpbmcgdGhyb3duLiBOdWxsIG9yIHVuZGVmaW5lZCB3aWxsIGJlIHJldHVybmVkIGFzIHVuZGVmaW5lZC4gQW55IG90aGVyXG4gKiB0eXBlIHdpbGwgcmVzdWx0IGluIGFuIGV4Y2VwdGlvbiBiZWluZyB0aHJvd24uXG4gKlxuICogQHBhcmFtIHZhbHVlIEEgbnVtYmVyIG9yIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiBhIG5vbi1udW1lcmljIGZsb2F0LlxuICogQHJldHVybnMgVGhlIHZhbHVlIGFzIGEgbnVtYmVyLCBvciB1bmRlZmluZWQgaWYgaXQncyBudWxsL3VuZGVmaW5lZC5cbiAqL1xuZXhwb3J0IGNvbnN0IGxpbWl0ZWRQYXJzZURvdWJsZSA9ICh2YWx1ZTogc3RyaW5nIHwgbnVtYmVyKTogbnVtYmVyIHwgdW5kZWZpbmVkID0+IHtcbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PSBcInN0cmluZ1wiKSB7XG4gICAgcmV0dXJuIHBhcnNlRmxvYXRTdHJpbmcodmFsdWUpO1xuICB9XG4gIHJldHVybiBleHBlY3ROdW1iZXIodmFsdWUpO1xufTtcblxuLyoqXG4gKiBAZGVwcmVjYXRlZCBVc2UgbGltaXRlZFBhcnNlRG91YmxlXG4gKi9cbmV4cG9ydCBjb25zdCBoYW5kbGVGbG9hdCA9IGxpbWl0ZWRQYXJzZURvdWJsZTtcblxuLyoqXG4gKiBAZGVwcmVjYXRlZCBVc2UgbGltaXRlZFBhcnNlRG91YmxlXG4gKi9cbmV4cG9ydCBjb25zdCBsaW1pdGVkUGFyc2VGbG9hdCA9IGxpbWl0ZWRQYXJzZURvdWJsZTtcblxuLyoqXG4gKiBBc3NlcnRzIGEgdmFsdWUgaXMgYSAzMi1iaXQgZmxvYXQgYW5kIHJldHVybnMgaXQuIElmIHRoZSB2YWx1ZSBpcyBhIHN0cmluZ1xuICogcmVwcmVzZW50YXRpb24gb2YgYSBub24tbnVtZXJpYyBudW1iZXIgdHlwZSAoTmFOLCBJbmZpbml0eSwgLUluZmluaXR5KSxcbiAqIHRoZSB2YWx1ZSB3aWxsIGJlIHBhcnNlZC4gQW55IG90aGVyIHN0cmluZyB2YWx1ZSB3aWxsIHJlc3VsdCBpbiBhbiBleGNlcHRpb25cbiAqIGJlaW5nIHRocm93bi4gTnVsbCBvciB1bmRlZmluZWQgd2lsbCBiZSByZXR1cm5lZCBhcyB1bmRlZmluZWQuIEFueSBvdGhlclxuICogdHlwZSB3aWxsIHJlc3VsdCBpbiBhbiBleGNlcHRpb24gYmVpbmcgdGhyb3duLlxuICpcbiAqIEBwYXJhbSB2YWx1ZSBBIG51bWJlciBvciBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBub24tbnVtZXJpYyBmbG9hdC5cbiAqIEByZXR1cm5zIFRoZSB2YWx1ZSBhcyBhIG51bWJlciwgb3IgdW5kZWZpbmVkIGlmIGl0J3MgbnVsbC91bmRlZmluZWQuXG4gKi9cbmV4cG9ydCBjb25zdCBsaW1pdGVkUGFyc2VGbG9hdDMyID0gKHZhbHVlOiBzdHJpbmcgfCBudW1iZXIpOiBudW1iZXIgfCB1bmRlZmluZWQgPT4ge1xuICBpZiAodHlwZW9mIHZhbHVlID09IFwic3RyaW5nXCIpIHtcbiAgICByZXR1cm4gcGFyc2VGbG9hdFN0cmluZyh2YWx1ZSk7XG4gIH1cbiAgcmV0dXJuIGV4cGVjdEZsb2F0MzIodmFsdWUpO1xufTtcblxuY29uc3QgcGFyc2VGbG9hdFN0cmluZyA9ICh2YWx1ZTogc3RyaW5nKTogbnVtYmVyID0+IHtcbiAgc3dpdGNoICh2YWx1ZSkge1xuICAgIGNhc2UgXCJOYU5cIjpcbiAgICAgIHJldHVybiBOYU47XG4gICAgY2FzZSBcIkluZmluaXR5XCI6XG4gICAgICByZXR1cm4gSW5maW5pdHk7XG4gICAgY2FzZSBcIi1JbmZpbml0eVwiOlxuICAgICAgcmV0dXJuIC1JbmZpbml0eTtcbiAgICBkZWZhdWx0OlxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmFibGUgdG8gcGFyc2UgZmxvYXQgdmFsdWU6ICR7dmFsdWV9YCk7XG4gIH1cbn07XG5cbi8qKlxuICogUGFyc2VzIGEgdmFsdWUgaW50byBhbiBpbnRlZ2VyLiBJZiB0aGUgdmFsdWUgaXMgbnVsbCBvciB1bmRlZmluZWQsIHVuZGVmaW5lZFxuICogd2lsbCBiZSByZXR1cm5lZC4gSWYgdGhlIHZhbHVlIGlzIGEgc3RyaW5nLCBpdCB3aWxsIGJlIHBhcnNlZCBieSBwYXJzZUZsb2F0XG4gKiBhbmQgdGhlIHJlc3VsdCB3aWxsIGJlIGFzc2VydGVkIHRvIGJlIGFuIGludGVnZXIuIElmIHRoZSBwYXJzZWQgdmFsdWUgaXMgbm90XG4gKiBhbiBpbnRlZ2VyLCBvciB0aGUgcmF3IHZhbHVlIGlzIGFueSB0eXBlIG90aGVyIHRoYW4gYSBzdHJpbmcgb3IgbnVtYmVyLCBhblxuICogZXhjZXB0aW9uIHdpbGwgYmUgdGhyb3duLlxuICpcbiAqIEBwYXJhbSB2YWx1ZSBBIG51bWJlciBvciBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYW4gaW50ZWdlci5cbiAqIEByZXR1cm5zIFRoZSB2YWx1ZSBhcyBhIG51bWJlciwgb3IgdW5kZWZpbmVkIGlmIGl0J3MgbnVsbC91bmRlZmluZWQuXG4gKi9cbmV4cG9ydCBjb25zdCBzdHJpY3RQYXJzZUxvbmcgPSAodmFsdWU6IHN0cmluZyB8IG51bWJlcik6IG51bWJlciB8IHVuZGVmaW5lZCA9PiB7XG4gIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAvLyBwYXJzZUludCBjYW4ndCBiZSB1c2VkIGhlcmUsIGJlY2F1c2UgaXQgd2lsbCBzaWxlbnRseSBkaXNjYXJkIGFueVxuICAgIC8vIGV4aXN0aW5nIGRlY2ltYWxzLiBXZSB3YW50IHRvIGluc3RlYWQgdGhyb3cgYW4gZXJyb3IgaWYgdGhlcmUgYXJlIGFueS5cbiAgICByZXR1cm4gZXhwZWN0TG9uZyhwYXJzZU51bWJlcih2YWx1ZSkpO1xuICB9XG4gIHJldHVybiBleHBlY3RMb25nKHZhbHVlKTtcbn07XG5cbi8qKlxuICogQGRlcHJlY2F0ZWQgVXNlIHN0cmljdFBhcnNlTG9uZ1xuICovXG5leHBvcnQgY29uc3Qgc3RyaWN0UGFyc2VJbnQgPSBzdHJpY3RQYXJzZUxvbmc7XG5cbi8qKlxuICogUGFyc2VzIGEgdmFsdWUgaW50byBhIDMyLWJpdCBpbnRlZ2VyLiBJZiB0aGUgdmFsdWUgaXMgbnVsbCBvciB1bmRlZmluZWQsIHVuZGVmaW5lZFxuICogd2lsbCBiZSByZXR1cm5lZC4gSWYgdGhlIHZhbHVlIGlzIGEgc3RyaW5nLCBpdCB3aWxsIGJlIHBhcnNlZCBieSBwYXJzZUZsb2F0XG4gKiBhbmQgdGhlIHJlc3VsdCB3aWxsIGJlIGFzc2VydGVkIHRvIGJlIGFuIGludGVnZXIuIElmIHRoZSBwYXJzZWQgdmFsdWUgaXMgbm90XG4gKiBhbiBpbnRlZ2VyLCBvciB0aGUgcmF3IHZhbHVlIGlzIGFueSB0eXBlIG90aGVyIHRoYW4gYSBzdHJpbmcgb3IgbnVtYmVyLCBhblxuICogZXhjZXB0aW9uIHdpbGwgYmUgdGhyb3duLlxuICpcbiAqIEBwYXJhbSB2YWx1ZSBBIG51bWJlciBvciBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSAzMi1iaXQgaW50ZWdlci5cbiAqIEByZXR1cm5zIFRoZSB2YWx1ZSBhcyBhIG51bWJlciwgb3IgdW5kZWZpbmVkIGlmIGl0J3MgbnVsbC91bmRlZmluZWQuXG4gKi9cbmV4cG9ydCBjb25zdCBzdHJpY3RQYXJzZUludDMyID0gKHZhbHVlOiBzdHJpbmcgfCBudW1iZXIpOiBudW1iZXIgfCB1bmRlZmluZWQgPT4ge1xuICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgLy8gcGFyc2VJbnQgY2FuJ3QgYmUgdXNlZCBoZXJlLCBiZWNhdXNlIGl0IHdpbGwgc2lsZW50bHkgZGlzY2FyZCBhbnlcbiAgICAvLyBleGlzdGluZyBkZWNpbWFscy4gV2Ugd2FudCB0byBpbnN0ZWFkIHRocm93IGFuIGVycm9yIGlmIHRoZXJlIGFyZSBhbnkuXG4gICAgcmV0dXJuIGV4cGVjdEludDMyKHBhcnNlTnVtYmVyKHZhbHVlKSk7XG4gIH1cbiAgcmV0dXJuIGV4cGVjdEludDMyKHZhbHVlKTtcbn07XG5cbi8qKlxuICogUGFyc2VzIGEgdmFsdWUgaW50byBhIDE2LWJpdCBpbnRlZ2VyLiBJZiB0aGUgdmFsdWUgaXMgbnVsbCBvciB1bmRlZmluZWQsIHVuZGVmaW5lZFxuICogd2lsbCBiZSByZXR1cm5lZC4gSWYgdGhlIHZhbHVlIGlzIGEgc3RyaW5nLCBpdCB3aWxsIGJlIHBhcnNlZCBieSBwYXJzZUZsb2F0XG4gKiBhbmQgdGhlIHJlc3VsdCB3aWxsIGJlIGFzc2VydGVkIHRvIGJlIGFuIGludGVnZXIuIElmIHRoZSBwYXJzZWQgdmFsdWUgaXMgbm90XG4gKiBhbiBpbnRlZ2VyLCBvciB0aGUgcmF3IHZhbHVlIGlzIGFueSB0eXBlIG90aGVyIHRoYW4gYSBzdHJpbmcgb3IgbnVtYmVyLCBhblxuICogZXhjZXB0aW9uIHdpbGwgYmUgdGhyb3duLlxuICpcbiAqIEBwYXJhbSB2YWx1ZSBBIG51bWJlciBvciBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSAxNi1iaXQgaW50ZWdlci5cbiAqIEByZXR1cm5zIFRoZSB2YWx1ZSBhcyBhIG51bWJlciwgb3IgdW5kZWZpbmVkIGlmIGl0J3MgbnVsbC91bmRlZmluZWQuXG4gKi9cbmV4cG9ydCBjb25zdCBzdHJpY3RQYXJzZVNob3J0ID0gKHZhbHVlOiBzdHJpbmcgfCBudW1iZXIpOiBudW1iZXIgfCB1bmRlZmluZWQgPT4ge1xuICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgLy8gcGFyc2VJbnQgY2FuJ3QgYmUgdXNlZCBoZXJlLCBiZWNhdXNlIGl0IHdpbGwgc2lsZW50bHkgZGlzY2FyZCBhbnlcbiAgICAvLyBleGlzdGluZyBkZWNpbWFscy4gV2Ugd2FudCB0byBpbnN0ZWFkIHRocm93IGFuIGVycm9yIGlmIHRoZXJlIGFyZSBhbnkuXG4gICAgcmV0dXJuIGV4cGVjdFNob3J0KHBhcnNlTnVtYmVyKHZhbHVlKSk7XG4gIH1cbiAgcmV0dXJuIGV4cGVjdFNob3J0KHZhbHVlKTtcbn07XG5cbi8qKlxuICogUGFyc2VzIGEgdmFsdWUgaW50byBhbiA4LWJpdCBpbnRlZ2VyLiBJZiB0aGUgdmFsdWUgaXMgbnVsbCBvciB1bmRlZmluZWQsIHVuZGVmaW5lZFxuICogd2lsbCBiZSByZXR1cm5lZC4gSWYgdGhlIHZhbHVlIGlzIGEgc3RyaW5nLCBpdCB3aWxsIGJlIHBhcnNlZCBieSBwYXJzZUZsb2F0XG4gKiBhbmQgdGhlIHJlc3VsdCB3aWxsIGJlIGFzc2VydGVkIHRvIGJlIGFuIGludGVnZXIuIElmIHRoZSBwYXJzZWQgdmFsdWUgaXMgbm90XG4gKiBhbiBpbnRlZ2VyLCBvciB0aGUgcmF3IHZhbHVlIGlzIGFueSB0eXBlIG90aGVyIHRoYW4gYSBzdHJpbmcgb3IgbnVtYmVyLCBhblxuICogZXhjZXB0aW9uIHdpbGwgYmUgdGhyb3duLlxuICpcbiAqIEBwYXJhbSB2YWx1ZSBBIG51bWJlciBvciBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYW4gOC1iaXQgaW50ZWdlci5cbiAqIEByZXR1cm5zIFRoZSB2YWx1ZSBhcyBhIG51bWJlciwgb3IgdW5kZWZpbmVkIGlmIGl0J3MgbnVsbC91bmRlZmluZWQuXG4gKi9cbmV4cG9ydCBjb25zdCBzdHJpY3RQYXJzZUJ5dGUgPSAodmFsdWU6IHN0cmluZyB8IG51bWJlcik6IG51bWJlciB8IHVuZGVmaW5lZCA9PiB7XG4gIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAvLyBwYXJzZUludCBjYW4ndCBiZSB1c2VkIGhlcmUsIGJlY2F1c2UgaXQgd2lsbCBzaWxlbnRseSBkaXNjYXJkIGFueVxuICAgIC8vIGV4aXN0aW5nIGRlY2ltYWxzLiBXZSB3YW50IHRvIGluc3RlYWQgdGhyb3cgYW4gZXJyb3IgaWYgdGhlcmUgYXJlIGFueS5cbiAgICByZXR1cm4gZXhwZWN0Qnl0ZShwYXJzZU51bWJlcih2YWx1ZSkpO1xuICB9XG4gIHJldHVybiBleHBlY3RCeXRlKHZhbHVlKTtcbn07XG4iXX0=