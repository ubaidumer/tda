"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.checkExceptions = exports.WaiterState = exports.waiterServiceDefaults = void 0;
exports.waiterServiceDefaults = {
    minDelay: 2,
    maxDelay: 120,
};
var WaiterState;
(function (WaiterState) {
    WaiterState["ABORTED"] = "ABORTED";
    WaiterState["FAILURE"] = "FAILURE";
    WaiterState["SUCCESS"] = "SUCCESS";
    WaiterState["RETRY"] = "RETRY";
    WaiterState["TIMEOUT"] = "TIMEOUT";
})(WaiterState = exports.WaiterState || (exports.WaiterState = {}));
const checkExceptions = (result) => {
    if (result.state === WaiterState.ABORTED) {
        const abortError = new Error(`${JSON.stringify({
            ...result,
            reason: "Request was aborted",
        })}`);
        abortError.name = "AbortError";
        throw abortError;
    }
    else if (result.state === WaiterState.TIMEOUT) {
        const timeoutError = new Error(`${JSON.stringify({
            ...result,
            reason: "Waiter has timed out",
        })}`);
        timeoutError.name = "TimeoutError";
        throw timeoutError;
    }
    else if (result.state !== WaiterState.SUCCESS) {
        throw new Error(`${JSON.stringify({ result })}`);
    }
    return result;
};
exports.checkExceptions = checkExceptions;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2FpdGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL3dhaXRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFPYSxRQUFBLHFCQUFxQixHQUFHO0lBQ25DLFFBQVEsRUFBRSxDQUFDO0lBQ1gsUUFBUSxFQUFFLEdBQUc7Q0FDZCxDQUFDO0FBUUYsSUFBWSxXQU1YO0FBTkQsV0FBWSxXQUFXO0lBQ3JCLGtDQUFtQixDQUFBO0lBQ25CLGtDQUFtQixDQUFBO0lBQ25CLGtDQUFtQixDQUFBO0lBQ25CLDhCQUFlLENBQUE7SUFDZixrQ0FBbUIsQ0FBQTtBQUNyQixDQUFDLEVBTlcsV0FBVyxHQUFYLG1CQUFXLEtBQVgsbUJBQVcsUUFNdEI7QUFlTSxNQUFNLGVBQWUsR0FBRyxDQUFDLE1BQW9CLEVBQWdCLEVBQUU7SUFDcEUsSUFBSSxNQUFNLENBQUMsS0FBSyxLQUFLLFdBQVcsQ0FBQyxPQUFPLEVBQUU7UUFDeEMsTUFBTSxVQUFVLEdBQUcsSUFBSSxLQUFLLENBQzFCLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQztZQUNoQixHQUFHLE1BQU07WUFDVCxNQUFNLEVBQUUscUJBQXFCO1NBQzlCLENBQUMsRUFBRSxDQUNMLENBQUM7UUFDRixVQUFVLENBQUMsSUFBSSxHQUFHLFlBQVksQ0FBQztRQUMvQixNQUFNLFVBQVUsQ0FBQztLQUNsQjtTQUFNLElBQUksTUFBTSxDQUFDLEtBQUssS0FBSyxXQUFXLENBQUMsT0FBTyxFQUFFO1FBQy9DLE1BQU0sWUFBWSxHQUFHLElBQUksS0FBSyxDQUM1QixHQUFHLElBQUksQ0FBQyxTQUFTLENBQUM7WUFDaEIsR0FBRyxNQUFNO1lBQ1QsTUFBTSxFQUFFLHNCQUFzQjtTQUMvQixDQUFDLEVBQUUsQ0FDTCxDQUFDO1FBQ0YsWUFBWSxDQUFDLElBQUksR0FBRyxjQUFjLENBQUM7UUFDbkMsTUFBTSxZQUFZLENBQUM7S0FDcEI7U0FBTSxJQUFJLE1BQU0sQ0FBQyxLQUFLLEtBQUssV0FBVyxDQUFDLE9BQU8sRUFBRTtRQUMvQyxNQUFNLElBQUksS0FBSyxDQUFDLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxFQUFFLE1BQU0sRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0tBQ2xEO0lBQ0QsT0FBTyxNQUFNLENBQUM7QUFDaEIsQ0FBQyxDQUFDO0FBdkJXLFFBQUEsZUFBZSxtQkF1QjFCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgV2FpdGVyQ29uZmlndXJhdGlvbiBhcyBXYWl0ZXJDb25maWd1cmF0aW9uX18gfSBmcm9tIFwiQGF3cy1zZGsvdHlwZXNcIjtcblxuZXhwb3J0IGludGVyZmFjZSBXYWl0ZXJDb25maWd1cmF0aW9uPFQ+IGV4dGVuZHMgV2FpdGVyQ29uZmlndXJhdGlvbl9fPFQ+IHt9XG5cbi8qKlxuICogQHByaXZhdGVcbiAqL1xuZXhwb3J0IGNvbnN0IHdhaXRlclNlcnZpY2VEZWZhdWx0cyA9IHtcbiAgbWluRGVsYXk6IDIsXG4gIG1heERlbGF5OiAxMjAsXG59O1xuXG4vKipcbiAqIEBwcml2YXRlXG4gKi9cbmV4cG9ydCB0eXBlIFdhaXRlck9wdGlvbnM8Q2xpZW50PiA9IFdhaXRlckNvbmZpZ3VyYXRpb248Q2xpZW50PiAmXG4gIFJlcXVpcmVkPFBpY2s8V2FpdGVyQ29uZmlndXJhdGlvbjxDbGllbnQ+LCBcIm1pbkRlbGF5XCIgfCBcIm1heERlbGF5XCI+PjtcblxuZXhwb3J0IGVudW0gV2FpdGVyU3RhdGUge1xuICBBQk9SVEVEID0gXCJBQk9SVEVEXCIsXG4gIEZBSUxVUkUgPSBcIkZBSUxVUkVcIixcbiAgU1VDQ0VTUyA9IFwiU1VDQ0VTU1wiLFxuICBSRVRSWSA9IFwiUkVUUllcIixcbiAgVElNRU9VVCA9IFwiVElNRU9VVFwiLFxufVxuXG5leHBvcnQgdHlwZSBXYWl0ZXJSZXN1bHQgPSB7XG4gIHN0YXRlOiBXYWl0ZXJTdGF0ZTtcblxuICAvKipcbiAgICogKG9wdGlvbmFsKSBJbmRpY2F0ZXMgYSByZWFzb24gZm9yIHdoeSBhIHdhaXRlciBoYXMgcmVhY2hlZCBpdHMgc3RhdGUuXG4gICAqL1xuICByZWFzb24/OiBhbnk7XG59O1xuXG4vKipcbiAqIEhhbmRsZXMgYW5kIHRocm93cyBleGNlcHRpb25zIHJlc3VsdGluZyBmcm9tIHRoZSB3YWl0ZXJSZXN1bHRcbiAqIEBwYXJhbSByZXN1bHQgV2FpdGVyUmVzdWx0XG4gKi9cbmV4cG9ydCBjb25zdCBjaGVja0V4Y2VwdGlvbnMgPSAocmVzdWx0OiBXYWl0ZXJSZXN1bHQpOiBXYWl0ZXJSZXN1bHQgPT4ge1xuICBpZiAocmVzdWx0LnN0YXRlID09PSBXYWl0ZXJTdGF0ZS5BQk9SVEVEKSB7XG4gICAgY29uc3QgYWJvcnRFcnJvciA9IG5ldyBFcnJvcihcbiAgICAgIGAke0pTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgLi4ucmVzdWx0LFxuICAgICAgICByZWFzb246IFwiUmVxdWVzdCB3YXMgYWJvcnRlZFwiLFxuICAgICAgfSl9YFxuICAgICk7XG4gICAgYWJvcnRFcnJvci5uYW1lID0gXCJBYm9ydEVycm9yXCI7XG4gICAgdGhyb3cgYWJvcnRFcnJvcjtcbiAgfSBlbHNlIGlmIChyZXN1bHQuc3RhdGUgPT09IFdhaXRlclN0YXRlLlRJTUVPVVQpIHtcbiAgICBjb25zdCB0aW1lb3V0RXJyb3IgPSBuZXcgRXJyb3IoXG4gICAgICBgJHtKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIC4uLnJlc3VsdCxcbiAgICAgICAgcmVhc29uOiBcIldhaXRlciBoYXMgdGltZWQgb3V0XCIsXG4gICAgICB9KX1gXG4gICAgKTtcbiAgICB0aW1lb3V0RXJyb3IubmFtZSA9IFwiVGltZW91dEVycm9yXCI7XG4gICAgdGhyb3cgdGltZW91dEVycm9yO1xuICB9IGVsc2UgaWYgKHJlc3VsdC5zdGF0ZSAhPT0gV2FpdGVyU3RhdGUuU1VDQ0VTUykge1xuICAgIHRocm93IG5ldyBFcnJvcihgJHtKU09OLnN0cmluZ2lmeSh7IHJlc3VsdCB9KX1gKTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufTtcbiJdfQ==