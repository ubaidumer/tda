export var setConnectionTimeout = function (request, reject, timeoutInMs) {
    if (timeoutInMs === void 0) { timeoutInMs = 0; }
    if (!timeoutInMs) {
        return;
    }
    request.on("socket", function (socket) {
        if (socket.connecting) {
            var timeoutId_1 = setTimeout(function () {
                request.destroy();
                reject(Object.assign(new Error("Socket timed out without establishing a connection within " + timeoutInMs + " ms"), {
                    name: "TimeoutError",
                }));
            }, timeoutInMs);
            socket.on("connect", function () {
                clearTimeout(timeoutId_1);
            });
        }
    });
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2V0LWNvbm5lY3Rpb24tdGltZW91dC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9zZXQtY29ubmVjdGlvbi10aW1lb3V0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUdBLE1BQU0sQ0FBQyxJQUFNLG9CQUFvQixHQUFHLFVBQUMsT0FBc0IsRUFBRSxNQUE0QixFQUFFLFdBQWU7SUFBZiw0QkFBQSxFQUFBLGVBQWU7SUFDeEcsSUFBSSxDQUFDLFdBQVcsRUFBRTtRQUNoQixPQUFPO0tBQ1I7SUFFRCxPQUFPLENBQUMsRUFBRSxDQUFDLFFBQVEsRUFBRSxVQUFDLE1BQWM7UUFDbEMsSUFBSSxNQUFNLENBQUMsVUFBVSxFQUFFO1lBRXJCLElBQU0sV0FBUyxHQUFHLFVBQVUsQ0FBQztnQkFFM0IsT0FBTyxDQUFDLE9BQU8sRUFBRSxDQUFDO2dCQUNsQixNQUFNLENBQ0osTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEtBQUssQ0FBQywrREFBNkQsV0FBVyxRQUFLLENBQUMsRUFBRTtvQkFDdEcsSUFBSSxFQUFFLGNBQWM7aUJBQ3JCLENBQUMsQ0FDSCxDQUFDO1lBQ0osQ0FBQyxFQUFFLFdBQVcsQ0FBQyxDQUFDO1lBR2hCLE1BQU0sQ0FBQyxFQUFFLENBQUMsU0FBUyxFQUFFO2dCQUNuQixZQUFZLENBQUMsV0FBUyxDQUFDLENBQUM7WUFDMUIsQ0FBQyxDQUFDLENBQUM7U0FDSjtJQUNILENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ2xpZW50UmVxdWVzdCB9IGZyb20gXCJodHRwXCI7XG5pbXBvcnQgeyBTb2NrZXQgfSBmcm9tIFwibmV0XCI7XG5cbmV4cG9ydCBjb25zdCBzZXRDb25uZWN0aW9uVGltZW91dCA9IChyZXF1ZXN0OiBDbGllbnRSZXF1ZXN0LCByZWplY3Q6IChlcnI6IEVycm9yKSA9PiB2b2lkLCB0aW1lb3V0SW5NcyA9IDApID0+IHtcbiAgaWYgKCF0aW1lb3V0SW5Ncykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHJlcXVlc3Qub24oXCJzb2NrZXRcIiwgKHNvY2tldDogU29ja2V0KSA9PiB7XG4gICAgaWYgKHNvY2tldC5jb25uZWN0aW5nKSB7XG4gICAgICAvLyBUaHJvdyBhIGNvbm5lY3RpbmcgdGltZW91dCBlcnJvciB1bmxlc3MgYSBjb25uZWN0aW9uIGlzIG1hZGUgd2l0aGluIHggdGltZS5cbiAgICAgIGNvbnN0IHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAvLyBkZXN0cm95IHRoZSByZXF1ZXN0LlxuICAgICAgICByZXF1ZXN0LmRlc3Ryb3koKTtcbiAgICAgICAgcmVqZWN0KFxuICAgICAgICAgIE9iamVjdC5hc3NpZ24obmV3IEVycm9yKGBTb2NrZXQgdGltZWQgb3V0IHdpdGhvdXQgZXN0YWJsaXNoaW5nIGEgY29ubmVjdGlvbiB3aXRoaW4gJHt0aW1lb3V0SW5Nc30gbXNgKSwge1xuICAgICAgICAgICAgbmFtZTogXCJUaW1lb3V0RXJyb3JcIixcbiAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgfSwgdGltZW91dEluTXMpO1xuXG4gICAgICAvLyBpZiB0aGUgY29ubmVjdGlvbiB3YXMgZXN0YWJsaXNoZWQsIGNhbmNlbCB0aGUgdGltZW91dC5cbiAgICAgIHNvY2tldC5vbihcImNvbm5lY3RcIiwgKCkgPT4ge1xuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG59O1xuIl19